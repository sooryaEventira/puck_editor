const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/OrganizationsListPage-BKl4uRS3.js","assets/js/puck-vendor-BeE6vXWX.js","assets/js/react-vendor-BdxBrZfF.js","assets/js/icons-vendor-B3tUBqWS.js","assets/js/eventLocalStore-CWbqpkVu.js","assets/js/indexedSearch-DGht6u-v.js","assets/js/OrganizationDetailPage-BAtUS-r_.js","assets/js/SpeakersListPage-p6ojObQ_.js","assets/js/publicSpeakerService-BSwYM8d4.js","assets/js/index-BmzR9LWJ.js","assets/css/index-C7-_kbUT.css","assets/js/SpeakerDetailPage-D_uZeu8M.js","assets/js/AttendeesListPage-Dt7K7QgH.js","assets/js/publicAttendeeService-CFOV4Dzm.js","assets/js/AttendeeDetailPage-BsGePt5R.js","assets/js/PublicSchedulePage-C1g5MQAr.js","assets/js/ScheduleContent-CHQq89M5.js","assets/js/Button-DeyD9Sc1.js","assets/js/UploadModal-BCOvM5Mg.js"])))=>i.map(i=>d[i]);
import{h as e,A as t,a as r,b as s,_ as a}from"./index-BmzR9LWJ.js";import{j as n,R as o}from"./puck-vendor-BeE6vXWX.js";import{r as i,R as l}from"./react-vendor-BdxBrZfF.js";import{g as c}from"./EditorView-O91Zsi56.js";import"./icons-vendor-B3tUBqWS.js";import"./survey-vendor-CTcUtol2.js";import"./ScheduleContent-CHQq89M5.js";import"./Button-DeyD9Sc1.js";import"./UploadModal-BCOvM5Mg.js";import"./resourceService-E_3_qt9z.js";const d=({eventName:e,logoUrl:t,items:r,activePath:s,onNavigate:a})=>n.jsx("header",{className:"fixed top-0 left-0 z-[1000] w-full border-b border-slate-200 bg-primary-dark backdrop-blur",children:n.jsxs("div",{className:"mx-auto flex h-16 max-w-7xl items-center justify-between gap-4 px-4 sm:px-6",children:[n.jsx("button",{type:"button",onClick:()=>{var e;return a((null==(e=r[0])?void 0:e.path)??"/")},className:"flex min-w-0 items-center gap-3 text-left","aria-label":"Go to home",children:t?n.jsx("img",{src:t,alt:"Event logo",className:"h-9 w-9 rounded-md object-cover ring-1 ring-slate-200"}):n.jsx("div",{className:"h-9 w-9 rounded-md bg-slate-100 ring-1 ring-slate-200"})}),n.jsx("nav",{className:"hidden items-center gap-1 md:flex","aria-label":"Primary",children:r.map(e=>{const t=s===e.path;return n.jsx("button",{type:"button",onClick:()=>a(e.path),className:["rounded-lg px-3 py-2 text-sm font-semibold transition-colors",t?"bg-slate-100 text-black ":"text-white hover:bg-slate-100 hover:text-black"].join(" "),children:e.label},e.path)})}),n.jsx("nav",{className:"flex flex-1 items-center justify-end gap-2 overflow-x-auto md:hidden",children:r.map(e=>{const t=s===e.path;return n.jsx("button",{type:"button",onClick:()=>a(e.path),className:["whitespace-nowrap rounded-full px-3 py-1.5 text-xs font-semibold transition-colors",t?"bg-slate-900 text-white":"bg-slate-100 text-slate-700"].join(" "),children:e.label},e.path)})})]})}),u=async a=>{try{if(!a){const t=e("Event UUID is required.",void 0,"Event UUID is required.");throw new Error(t)}const o=t.PUBLIC.EVENT.GET(a),i=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json"}});if(!i||!i.ok){if(!i){const e=r(null);throw new Error(e)}try{const t=await i.text();let r=null;try{r=t?JSON.parse(t):null}catch{if(t&&t.trim()){const r=e(t.trim(),i,"An error occurred. Please try again.");throw new Error(r)}}if(r){const t=e(r,i,"An error occurred. Please try again.");throw new Error(t)}const s=e(null,i,"An error occurred. Please try again.");throw new Error(s)}catch(n){if(n instanceof Error)throw n;const t=e(null,i,"An error occurred. Please try again.");throw new Error(t)}}let l;try{l=await i.json()}catch{const e=s("Invalid response from server. Please try again.");throw new Error(e)}if("error"===(null==l?void 0:l.status)){const t=e(l,void 0,"Failed to fetch event. Please try again.");throw new Error(t)}const c=(null==l?void 0:l.data)??l;if(!c||"object"!=typeof c){const e=s("Invalid response from server. Please try again.");throw new Error(e)}return c}catch(o){if(o instanceof TypeError&&o.message.includes("fetch"))throw o.message.includes("Cannot connect")||r(),new Error(o.message||"Network error occurred");throw o instanceof Error?o:new Error("Failed to fetch event. Please try again.")}},h=async a=>{try{if(!a){const t=e("Event UUID is required.",void 0,"Event UUID is required.");throw new Error(t)}const o=t.PUBLIC.WEBPAGES.LIST(a),i=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json"}});if(!i||!i.ok){if(!i){const e=r(null);throw new Error(e)}try{const t=await i.text();let r=null;try{r=t?JSON.parse(t):null}catch{if(t&&t.trim()){const r=e(t.trim(),i,"An error occurred. Please try again.");throw new Error(r)}}if(r){const t=e(r,i,"An error occurred. Please try again.");throw new Error(t)}const s=e(null,i,"An error occurred. Please try again.");throw new Error(s)}catch(n){if(n instanceof Error)throw n;const t=e(null,i,"An error occurred. Please try again.");throw new Error(t)}}let l;try{l=await i.json()}catch{const e=s("Invalid response from server. Please try again.");throw new Error(e)}if("error"===(null==l?void 0:l.status)){const t=e(l,void 0,"Failed to fetch webpages. Please try again.");throw new Error(t)}const c=(null==l?void 0:l.data)??(null==l?void 0:l.results)??l;return Array.isArray(c)?c:c&&"object"==typeof c&&Array.isArray(c.results)?c.results:[]}catch(o){if(o instanceof TypeError&&o.message.includes("fetch"))throw o.message.includes("Cannot connect")||r(),new Error(o.message||"Network error occurred");throw o instanceof Error?o:new Error("Failed to fetch webpages. Please try again.")}},m=({eventUuid:a,webpageUuid:l})=>{var d,u;const[h,m]=i.useState(null),[p,g]=i.useState(!0),[w,x]=i.useState(null);i.useEffect(()=>{let n=!1;return(async()=>{g(!0),x(null);try{const o=await(async(a,n)=>{try{if(!a){const t=e("Event UUID is required.",void 0,"Event UUID is required.");throw new Error(t)}if(!n){const t=e("Webpage UUID is required.",void 0,"Webpage UUID is required.");throw new Error(t)}const i=t.PUBLIC.WEBPAGES.GET(a,n),l=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json"}});if(!l||!l.ok){if(!l){const e=r(null);throw new Error(e)}try{const t=await l.text();let r=null;try{r=t?JSON.parse(t):null}catch{if(t&&t.trim()){const r=e(t.trim(),l,"An error occurred. Please try again.");throw new Error(r)}}if(r){const t=e(r,l,"An error occurred. Please try again.");throw new Error(t)}const s=e(null,l,"An error occurred. Please try again.");throw new Error(s)}catch(o){if(o instanceof Error)throw o;const t=e(null,l,"An error occurred. Please try again.");throw new Error(t)}}let c;try{c=await l.json()}catch{const e=s("Invalid response from server. Please try again.");throw new Error(e)}if("error"===(null==c?void 0:c.status)){const t=e(c,void 0,"Failed to fetch webpage. Please try again.");throw new Error(t)}const d=(null==c?void 0:c.data)??c;if(!d||"object"!=typeof d){const e=s("Invalid response from server. Please try again.");throw new Error(e)}return d}catch(w){if(w instanceof TypeError&&w.message.includes("fetch"))throw w.message.includes("Cannot connect")||r(),new Error(w.message||"Network error occurred");throw w instanceof Error?w:new Error("Failed to fetch webpage. Please try again.")}})(a,l);n||m(o)}catch(o){const e=o instanceof Error?o.message:"Failed to load page.";n||x(e)}finally{n||g(!1)}})(),()=>{n=!0}},[a,l]);const v=i.useMemo(()=>h?(e=>{const t=null==e?void 0:e.content;if(!t||"object"!=typeof t)return null;const r=Object.keys(t);if(0===r.length)return null;const s=t[r[0]];if(!s||!s.data)return null;const a=Object.keys(s.data);if(0===a.length)return null;const n="string"==typeof e.slug?e.slug.toLowerCase():void 0,o="string"==typeof s.slug?s.slug.toLowerCase():void 0;let i=a[0];n&&a.includes(n)?i=n:o&&a.includes(o)&&(i=o);const l=s.data[i];return l?{content:l.content||[],root:l.root||{},zones:l.zones||{}}:null})(h):null,[h]),f=null==(u=null==(d=null==v?void 0:v.root)?void 0:d.props)?void 0:u.pageType,y=null==h?void 0:h.name,b=i.useMemo(()=>c(f,y),[f,y]);return p?n.jsx("div",{className:"flex items-center justify-center py-16",children:n.jsx("div",{className:"text-sm font-medium text-slate-600",children:"Loading page…"})}):w?n.jsxs("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-6",children:[n.jsx("div",{className:"text-lg font-semibold text-rose-900",children:"Failed to load page"}),n.jsx("div",{className:"mt-1 text-sm text-rose-800",children:w})]}):h&&v?n.jsx("div",{className:"min-h-[50vh]",children:n.jsx(o,{config:b,data:v})}):n.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-6",children:[n.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Page not available"}),n.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"This page is missing or the response format is unsupported."})]})},p=l.lazy(()=>a(()=>import("./OrganizationsListPage-BKl4uRS3.js"),__vite__mapDeps([0,1,2,3,4,5]))),g=l.lazy(()=>a(()=>import("./OrganizationDetailPage-BAtUS-r_.js"),__vite__mapDeps([6,1,2,4]))),w=l.lazy(()=>a(()=>import("./SpeakersListPage-p6ojObQ_.js"),__vite__mapDeps([7,1,2,3,4,8,9,10,5]))),x=l.lazy(()=>a(()=>import("./SpeakerDetailPage-D_uZeu8M.js"),__vite__mapDeps([11,1,2,4,8,9,3,10]))),v=l.lazy(()=>a(()=>import("./AttendeesListPage-Dt7K7QgH.js"),__vite__mapDeps([12,1,2,3,4,13,9,10,5]))),f=l.lazy(()=>a(()=>import("./AttendeeDetailPage-BsGePt5R.js"),__vite__mapDeps([14,1,2,4,13,9,3,10]))),y=l.lazy(()=>a(()=>import("./PublicSchedulePage-C1g5MQAr.js"),__vite__mapDeps([15,1,2,4,16,3,9,10,17,18]))),b=({eventUuid:e})=>{var t;const[r,s]=i.useState(null),[a,o]=i.useState([]),[c,b]=i.useState(!0),[j,E]=i.useState(null),[N,P]=i.useState(window.location.pathname);i.useEffect(()=>{(async()=>{b(!0),E(null);try{const[t,r]=await Promise.all([u(e),h(e)]);s(t),o(Array.isArray(r)?r:[])}catch(t){const e=t instanceof Error?t.message:"Failed to load website.";E(e)}finally{b(!1)}})();const t=()=>P(window.location.pathname);return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)},[e]);const k=i.useMemo(()=>{const t=`navigation-hidden-${e}`;let r=new Set;try{const e=localStorage.getItem(t),s=e?JSON.parse(e):[];Array.isArray(s)&&(r=new Set(s.map(String)))}catch{r=new Set}return[...[{id:"system:organizations",label:"Organizations",path:`/events/${e}/organizations`},{id:"system:speakers",label:"Speakers",path:`/events/${e}/speakers`},{id:"system:attendees",label:"Attendees",path:`/events/${e}/attendees`},{id:"system:schedule",label:"Schedule",path:`/events/${e}/schedule`}].filter(e=>!r.has(e.id||"")),...a.map(t=>({id:String(t.uuid),label:t.name,path:`/events/${e}/webpages/${t.uuid}`})).filter(e=>!r.has(e.id||""))]},[e,a]),S=i.useMemo(()=>((e,t)=>{const r=`/events/${e}`,s=t.startsWith(r)?t.slice(r.length):t,a=s.match(/^\/webpages\/([^/]+)\/?$/);if(a)return{section:"webpage",webpageUuid:a[1]};const n=s.match(/^\/speakers\/([^/]+)\/?$/);if(n)return{section:"speaker",speakerId:n[1]};const o=s.match(/^\/attendees\/([^/]+)\/?$/);if(o)return{section:"attendee",attendeeId:o[1]};const i=s.match(/^\/organizations\/([^/]+)\/?$/);return i?{section:"organization",organizationId:i[1]}:s.startsWith("/organizations")?{section:"organizations"}:s.startsWith("/speakers")?{section:"speakers"}:s.startsWith("/attendees")?{section:"attendees"}:s.startsWith("/schedule")?{section:"schedule"}:s.startsWith("/sessions")?{section:"sessions"}:{section:"webpage"}})(e,N),[e,N]),U=null==(t=a[0])?void 0:t.uuid,_=S.webpageUuid??U,I=e=>{window.history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate"))};return n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsx(d,{eventName:null==r?void 0:r.eventName,logoUrl:(null==r?void 0:r.logo)??null,items:k,activePath:N,onNavigate:I}),n.jsx("main",{className:"mx-auto max-w-7xl px-4 pb-12 pt-20 sm:px-6",children:c?n.jsx("div",{className:"flex items-center justify-center py-16",children:n.jsx("div",{className:"text-sm font-medium text-slate-600",children:"Loading website…"})}):j?n.jsxs("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-6",children:[n.jsx("div",{className:"text-lg font-semibold text-rose-900",children:"Unable to load this event"}),n.jsx("div",{className:"mt-1 text-sm text-rose-800",children:j})]}):"organizations"===S.section?n.jsx(l.Suspense,{fallback:n.jsx("div",{className:"py-10 text-sm text-slate-600",children:"Loading…"}),children:n.jsx(p,{eventUuid:e,onNavigate:I})}):"speakers"===S.section?n.jsx(l.Suspense,{fallback:n.jsx("div",{className:"py-10 text-sm text-slate-600",children:"Loading…"}),children:n.jsx(w,{eventUuid:e,onNavigate:I})}):"speaker"===S.section?n.jsx(l.Suspense,{fallback:n.jsx("div",{className:"py-10 text-sm text-slate-600",children:"Loading…"}),children:n.jsx(x,{eventUuid:e,speakerId:S.speakerId||"",onNavigate:I})}):"attendees"===S.section?n.jsx(l.Suspense,{fallback:n.jsx("div",{className:"py-10 text-sm text-slate-600",children:"Loading…"}),children:n.jsx(v,{eventUuid:e,onNavigate:I})}):"attendee"===S.section?n.jsx(l.Suspense,{fallback:n.jsx("div",{className:"py-10 text-sm text-slate-600",children:"Loading…"}),children:n.jsx(f,{eventUuid:e,attendeeId:S.attendeeId||"",onNavigate:I})}):"organization"===S.section?n.jsx(l.Suspense,{fallback:n.jsx("div",{className:"py-10 text-sm text-slate-600",children:"Loading…"}),children:n.jsx(g,{eventUuid:e,organizationId:S.organizationId||"",onNavigate:I})}):"schedule"===S.section||"sessions"===S.section?n.jsx(l.Suspense,{fallback:n.jsx("div",{className:"py-10 text-sm text-slate-600",children:"Loading…"}),children:n.jsx(y,{eventUuid:e})}):"webpage"===S.section?_?n.jsx(m,{eventUuid:e,webpageUuid:_}):n.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-6",children:[n.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"No pages yet"}),n.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"This event doesn’t have any published webpages."})]}):n.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-6",children:[n.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Coming soon"}),n.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"This section will be connected once the public endpoints are provided."})]})})]})};export{b as default};
