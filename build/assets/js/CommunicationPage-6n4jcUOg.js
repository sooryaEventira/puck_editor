import{j as e}from"./puck-vendor-BeE6vXWX.js";import{R as t,r as s}from"./react-vendor-BdxBrZfF.js";import{B as r,M as n,h as a,A as o,a as i,b as l,s as c,u as d,E as u}from"./index-Cuj1Wa0k.js";import{d as m,E as h}from"./EventHubContent-CdAXmn2h.js";import{D as g,T as p}from"./TablePagination-C7df1bUm.js";import{u as x}from"./TableHeader-BrODSdjp.js";import{H as f,M as b,B as w,P as v,T as y,j,k as N,g as E,l as C,m as S,n as A,o as D,p as T,q as k,r as M,s as I,t as P,u as F,b as U,X as L,I as z,d as O,e as R}from"./icons-vendor-BRMUrJuS.js";import{B as _}from"./Button-Dnrs5iTq.js";const B=({checked:s,indeterminate:r,onChange:n,ariaLabel:a})=>{const o=t.useRef(null);return t.useEffect(()=>{o.current&&(o.current.indeterminate=r)},[r]),e.jsx("input",{ref:o,type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40","aria-label":a,checked:s,onChange:e=>n(e.target.checked)})},q=e=>{switch(e){case"sent":return"success";case"scheduled":return"primary";case"draft":return"warning";default:return"neutral"}},H=({communications:n,macros:a=[],onCreateBroadcast:o,onEditCommunication:i,onCreateMacro:l,onEditMacro:c,onDeleteMacro:d,isLoading:u=!1})=>{const[m,h]=s.useState(""),[j,N]=s.useState("list"),[E,C]=s.useState(new Set),[S,A]=s.useState(new Set),[D,T]=s.useState(1),[k,M]=s.useState({list:{column:"title",direction:"ascending"},macros:{column:"macro",direction:"ascending"}}),I=s.useMemo(()=>{const e=m.trim().toLowerCase();return e?n.filter(t=>[t.title,...t.userGroups.map(e=>e.name),t.status,t.type].filter(Boolean).join(" ").toLowerCase().includes(e)):n},[m,n]),P=s.useMemo(()=>{const e=m.trim().toLowerCase();return e?a.filter(t=>[t.macro,t.column].filter(Boolean).join(" ").toLowerCase().includes(e)):a},[m,a]),F=s.useMemo(()=>I.map(e=>e.id),[I]),U=s.useMemo(()=>P.map(e=>e.id),[P]),L=s.useMemo(()=>{const e=10*(D-1),t=e+10;return I.slice(e,t)},[I,D]),z=s.useMemo(()=>{const e=10*(D-1),t=e+10;return P.slice(e,t)},[P,D]),O=s.useMemo(()=>{const e="list"===j?I.length:P.length;return Math.ceil(e/10)},[j,I.length,P.length]),R=s.useMemo(()=>"list"===j?F.length>0&&F.every(e=>E.has(e)):U.length>0&&U.every(e=>S.has(e)),[j,F,U,E,S]),_=s.useMemo(()=>"list"===j?!R&&F.some(e=>E.has(e)):!R&&U.some(e=>S.has(e)),[j,R,F,U,E,S]),H=s.useCallback(e=>{"list"===j?C(t=>{const s=new Set(t);return F.forEach(t=>{e?s.add(t):s.delete(t)}),s}):A(t=>{const s=new Set(t);return U.forEach(t=>{e?s.add(t):s.delete(t)}),s})},[j,F,U]),$=s.useCallback((e,t)=>{"list"===j?C(s=>{const r=new Set(s);return t?r.add(e):r.delete(e),r}):A(s=>{const r=new Set(s);return t?r.add(e):r.delete(e),r})},[j]),G=s.useMemo(()=>"list"===j?L.map((e,t)=>({communication:e,index:t})):z.map((e,t)=>({macro:e,index:t})),[j,L,z]),J=(({allVisibleSelected:t,partiallySelected:n,selectedCommunicationIds:a,onToggleAllVisible:o,onToggleRow:i,onEditCommunication:l})=>s.useMemo(()=>[{id:"title",header:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{checked:t,indeterminate:n,onChange:o,ariaLabel:"Select all communications"}),e.jsx("span",{children:"Title"})]}),sortable:!0,sortAccessor:({communication:e})=>(null==e?void 0:e.title)||"",render:({communication:t})=>t?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40","aria-label":`Select ${t.title}`,checked:a.has(t.id),onChange:e=>i(t.id,e.target.checked)}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:t.title})]}):null},{id:"userGroups",header:"Groups",sortable:!0,sortAccessor:({communication:e})=>(null==e?void 0:e.userGroups.map(e=>e.name).join(" "))||"",render:({communication:t})=>t?0===t.userGroups.length?e.jsx("span",{className:"text-sm text-slate-400",children:"No groups"}):e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.userGroups.slice(0,3).map(t=>{return e.jsx(r,{variant:(s=t.variant,"primary"===s?"primary":"secondary"===s?"info":"muted"),children:t.name},t.id);var s}),t.userGroups.length>3&&e.jsxs(r,{variant:"muted",children:["+",t.userGroups.length-3]})]}):null},{id:"status",header:"Status",sortable:!0,sortAccessor:({communication:e})=>(null==e?void 0:e.status)||"",render:({communication:t})=>t?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{variant:q(t.status),children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),"scheduled"===t.status&&t.scheduledDate&&e.jsxs("div",{className:"group relative",children:[e.jsx(f,{className:"h-4 w-4 text-slate-500 cursor-help"}),e.jsx("div",{className:"absolute left-0 top-6 z-10 hidden w-48 rounded-md bg-slate-900 px-3 py-2 text-xs text-white shadow-lg group-hover:block",children:new Date(t.scheduledDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}):null},{id:"type",header:"Type",sortable:!0,sortAccessor:({communication:e})=>(null==e?void 0:e.type)||"",render:({communication:t})=>t?e.jsx("div",{className:"flex items-center",children:"email"===t.type?e.jsx(b,{className:"h-5 w-5 text-slate-500"}):e.jsx(w,{className:"h-5 w-5 text-slate-500"})}):null},{id:"recipients",header:"Recipients",sortable:!0,sortAccessor:({communication:e})=>(null==e?void 0:e.recipients.sent)||0,render:({communication:t})=>t?e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[t.recipients.sent,"/",t.recipients.total]}):null},{id:"actions",header:"",align:"right",render:({communication:t})=>t?e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>null==l?void 0:l(t.id),className:"flex h-9 w-9 items-center justify-center text-slate-500 transition hover:text-primary focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40","aria-label":`Edit ${t.title}`,children:e.jsx(v,{className:"h-4 w-4",strokeWidth:1.8})}),e.jsx("button",{type:"button",className:"flex h-9 w-9 items-center justify-center text-slate-500 transition hover:border-rose-400 hover:text-rose-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300/60","aria-label":`Delete ${t.title}`,children:e.jsx(y,{className:"h-4 w-4",strokeWidth:1.8})})]}):null}],[t,n,a,o,i,l]))({allVisibleSelected:R,partiallySelected:_,selectedCommunicationIds:E,onToggleAllVisible:H,onToggleRow:$,onEditCommunication:i}),X=(({allVisibleSelected:t,partiallySelected:r,selectedMacroIds:n,onToggleAllVisible:a,onToggleRow:o,onEditMacro:i,onDeleteMacro:l})=>s.useMemo(()=>[{id:"macro",header:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{checked:t,indeterminate:r,onChange:a,ariaLabel:"Select all macros"}),e.jsx("span",{children:"Macro"})]}),sortable:!0,sortAccessor:({macro:e})=>(null==e?void 0:e.macro)||"",render:({macro:t})=>t?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40","aria-label":`Select ${t.macro}`,checked:n.has(t.id),onChange:e=>o(t.id,e.target.checked)}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:t.macro})]}):null},{id:"column",header:"Columns",sortable:!0,sortAccessor:({macro:e})=>(null==e?void 0:e.column)||"",render:({macro:t})=>t?e.jsx("span",{className:"text-sm text-slate-600",children:t.column}):null},{id:"actions",header:"",align:"right",render:({macro:t})=>t?e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>null==i?void 0:i(t.id),className:"flex h-9 w-9 items-center justify-center text-slate-500 transition hover:text-primary focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40","aria-label":`Edit ${t.macro}`,children:e.jsx(v,{className:"h-4 w-4",strokeWidth:1.8})}),e.jsx("button",{type:"button",onClick:()=>null==l?void 0:l(t.id),className:"flex h-9 w-9 items-center justify-center text-slate-500 transition hover:border-rose-400 hover:text-rose-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300/60","aria-label":`Delete ${t.macro}`,children:e.jsx(y,{className:"h-4 w-4",strokeWidth:1.8})})]}):null}],[t,r,n,a,o,i,l]))({allVisibleSelected:R,partiallySelected:_,selectedMacroIds:S,onToggleAllVisible:H,onToggleRow:$,onEditMacro:c,onDeleteMacro:d}),V=s.useMemo(()=>"list"===j?J:X,[j,J,X]),W=e.jsx("div",{className:"flex min-h-[280px] items-center justify-center px-6 py-10 text-sm text-slate-500",children:"list"===j?0===n.length?"No emails/notifications created!":"No communications match your search.":0===a.length?"No macros created!":"No macros match your search."}),Y=x({tabs:[{id:"list",label:"List"},{id:"macros",label:"Macros"}],activeTabId:j,searchQuery:m,searchPlaceholder:"list"===j?"Search communication":"Search macros",onTabChange:e=>N(e),onSearchChange:h}),K=s.useCallback(e=>{M(t=>({...t,[j]:e}))},[j]);return t.useEffect(()=>{T(1)},[j]),u?e.jsxs("div",{className:"space-y-8 px-4 pb-12 pt-8 md:px-10 lg:px-16",children:[e.jsx("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:e.jsx("h1",{className:"text-[26px] font-bold text-primary-dark",children:"Communication"})}),e.jsx("div",{className:"flex min-h-[400px] items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-[#6938EF] mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Loading communications..."})]})})]}):e.jsxs("div",{className:"space-y-8 px-4 pb-12 pt-8 md:px-10 lg:px-16 ",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between ",children:[e.jsx("h1",{className:"text-[26px] font-bold text-primary-dark ",children:"Communication"}),e.jsx("div",{className:"flex items-center gap-3",children:"list"===j&&e.jsx("button",{type:"button",onClick:o,className:"inline-flex items-center justify-center rounded-md  px-4 py-2 text-sm font-semibold text-white border border-slate-200 bg-primary shadow-sm transition hover:bg-primary/90 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:"+ New broadcast"})})]}),e.jsx(g,{headerLeading:Y.leading,headerActions:Y.actions,data:G,columns:V,getRowKey:(e,t)=>{var s,r;return(null==(s=e.communication)?void 0:s.id)||(null==(r=e.macro)?void 0:r.id)||`row-${t}`},emptyState:W,sortDescriptor:k[j],onSortChange:K,footer:e.jsx(p,{currentPage:D,totalPages:O,onPageChange:T})})]})},$=({isOpen:t,onClose:r,onSelect:a})=>{const[o,i]=s.useState("push-notification"),l=e=>{i(e),a(e),r()};return e.jsx(n,{isVisible:t,onClose:()=>{i(null),r()},title:"Select broadcast type",subtitle:"Choose how to deliver your message to recipients.",width:548,maxWidth:548,borderRadius:16,showHeaderBorder:!1,padding:{top:24,right:24,bottom:24,left:24},children:e.jsxs("div",{className:"flex items-center justify-center gap-4 overflow-hidden",children:[e.jsx("button",{type:"button",onClick:()=>l("email"),className:"flex w-[240px] max-w-[240px] h-[100px] flex-col gap-2 rounded-xl border pt-4 pr-6 pb-4 pl-6 text-left transition-all "+("email"===o?"border-primary bg-primary/5":"border-slate-200 bg-white hover:border-primary/40 hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Email"}),e.jsx("span",{className:"text-xs text-slate-500 leading-relaxed",children:"Send via email to subscriber inboxes."})]}),e.jsx("div",{className:"flex h-5 w-5 items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("input",{type:"radio",name:"broadcast-type",checked:"email"===o,onChange:()=>l("email"),className:"h-4 w-4 border-slate-300 text-primary focus:ring-primary/40 accent-primary"})})]})}),e.jsx("button",{type:"button",onClick:()=>l("push-notification"),className:"flex w-[240px] max-w-[240px] h-[100px] flex-col gap-2 rounded-xl border pt-4 pr-6 pb-4 pl-6 text-left transition-all "+("push-notification"===o?"border-2 border-primary bg-primary/5":"border-slate-200 bg-white hover:border-primary/40 hover:bg-slate-50"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:"Push Notification"}),e.jsx("span",{className:"text-xs text-slate-500 leading-relaxed",children:"Send instant mobile/ browser notifications."})]}),e.jsx("div",{className:"flex h-5 w-5 items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("input",{type:"radio",name:"broadcast-type",checked:"push-notification"===o,onChange:()=>l("push-notification"),className:"h-4 w-4 border-slate-300 text-primary focus:ring-primary/40 accent-primary"})})]})})]})})},G=({isOpen:t,onClose:s,onSend:r,subject:a,message:o,isSending:i=!1,recipients:l=[]})=>e.jsx(n,{isVisible:t,onClose:s,title:"Preview ",width:600,maxWidth:800,borderRadius:16,padding:{top:24,right:24,bottom:24,left:24},children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"rounded-lg border border-slate-200 p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-slate-900",children:"Subject: "}),e.jsx("span",{className:"text-slate-700",children:a})]}),e.jsx("div",{className:"border-t border-slate-200 pt-4",children:e.jsx("div",{className:"broadcast-editor-content text-slate-600",dangerouslySetInnerHTML:{__html:o}})}),l.length>0&&e.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"font-bold text-slate-900",children:"Recipients: "})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:l.map((t,s)=>e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary/10 text-primary border border-primary/20",children:t},s))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:s,className:"rounded-md border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-primary/20",children:"Cancel"}),e.jsx("button",{type:"button",onClick:r,disabled:i,className:"rounded-md bg-primary px-4 py-2 text-sm font-medium text-white hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary/20 disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Sending...":"Send"})]})]})}),J=({isOpen:t,onClose:r,onSchedule:n})=>{const[a,o]=s.useState(new Date),[i,l]=s.useState(null),[c,d]=s.useState("10:00 AM");if(s.useEffect(()=>{t&&!i&&l(new Date)},[t,i]),!t)return null;const u=(e,t)=>new Date(e,t+1,0).getDate(),m=a.getFullYear(),h=a.getMonth(),g=u(m,h),p=new Date(m,h,1).getDay();const x=0===p?6:p-1;return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"w-full max-w-lg overflow-hidden rounded-xl bg-white shadow-2xl flex flex-col md:flex-row h-auto md:h-[500px] max-h-[90vh]",children:[e.jsxs("div",{className:"border-r-0 md:border-r border-[#E9EAEB] border-b md:border-b-0 bg-white p-2 md:p-3 flex flex-row md:flex-col gap-0.5 w-full md:w-[160px] overflow-x-auto md:overflow-x-visible shrink-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-col gap-0.5 shrink-0 min-w-[120px] md:min-w-0",children:[e.jsx("div",{className:"w-full px-3 py-2 bg-[#FAFAFA] border-b border-[#D5D7DA] flex items-center",children:e.jsx("div",{className:"text-sm font-semibold text-[#252B37]",children:"Date"})}),e.jsx("button",{onClick:()=>{const e=new Date;l(e),o(e)},className:"w-full px-3 py-2 rounded-md text-sm font-medium text-left transition whitespace-nowrap "+(i&&i.toDateString()===(new Date).toDateString()?"bg-primary/10 text-primary":"text-[#414651] hover:bg-slate-50"),children:"Today"})]}),e.jsxs("div",{className:"flex flex-col md:flex-col gap-0.5 shrink-0 min-w-[120px] md:min-w-0",children:[e.jsx("div",{className:"w-full px-3 py-2 bg-[#FAFAFA] border-b border-[#D5D7DA] flex items-center",children:e.jsx("div",{className:"text-sm font-semibold text-[#252B37]",children:"Time"})}),["10:00 AM","11:00 AM","12:00 PM"].map(t=>e.jsx("button",{onClick:()=>d(t),className:"w-full px-3 py-2 rounded-md text-sm font-medium text-left transition whitespace-nowrap "+(c===t?"bg-primary/10 text-primary":"text-[#414651] hover:bg-slate-50"),children:t},t)),e.jsx("button",{onClick:()=>d("Custom"),className:"w-full px-3 py-2 rounded-md text-sm font-medium text-left transition whitespace-nowrap "+("Custom"===c?"bg-primary/10 text-primary":"text-[#414651] hover:bg-slate-50"),children:"Custom time"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col px-3 sm:px-4 md:px-6 py-3 md:py-5 gap-3 overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-center relative px-6 sm:px-8",children:[e.jsx("button",{onClick:()=>{o(new Date(m,h-1,1))},className:"absolute left-0 p-1 text-slate-400 hover:text-slate-600 rounded-full hover:bg-slate-100",children:e.jsx(j,{className:"h-5 w-5"})}),e.jsxs("h2",{className:"text-sm font-semibold text-[#414651]",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][h]," ",m]}),e.jsx("button",{onClick:()=>{o(new Date(m,h+1,1))},className:"absolute right-0 p-1 text-slate-400 hover:text-slate-600 rounded-full hover:bg-slate-100",children:e.jsx(N,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-2 md:gap-3 min-h-0",children:[e.jsx("div",{className:"grid grid-cols-7 gap-1",children:["Mo","Tu","We","Th","Fr","Sa","Su"].map(t=>e.jsx("div",{className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 flex items-center justify-center",children:e.jsx("div",{className:"text-xs sm:text-sm font-medium text-[#414651]",children:t})},t))}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:x}).map((t,s)=>{const r=0===h?11:h-1,n=0===h?m-1:m,a=u(n,r)-x+s+1,o=new Date,i=o.getDate()===a&&o.getMonth()===r&&o.getFullYear()===n;return e.jsxs("div",{className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 relative flex items-center justify-center",children:[e.jsx("div",{className:"text-xs sm:text-sm font-normal text-[#717680]",children:a}),i&&e.jsx("div",{className:"absolute bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 md:w-1.5 md:h-1.5 rounded-full bg-[#A4A7AE]"})]},`prev-${s}`)}),Array.from({length:g}).map((t,s)=>{const r=s+1,n=(e=>!!i&&i.getDate()===e&&i.getMonth()===h&&i.getFullYear()===m)(r),a=(e=>{const t=new Date;return t.getDate()===e&&t.getMonth()===h&&t.getFullYear()===m})(r);return e.jsxs("button",{onClick:()=>(e=>{const t=new Date(m,h,e);l(t)})(r),className:`\n                      w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 relative flex items-center justify-center rounded-full text-xs sm:text-sm transition\n                      ${n?"bg-[#6938EF] text-white font-medium":a?"bg-[#FAFAFA] text-[#414651] font-medium hover:bg-[#FAFAFA]":"text-[#414651] font-normal hover:bg-[#FAFAFA] hover:text-[#252B37] hover:font-medium"}\n                    `,children:[e.jsx("div",{children:r}),a&&!n&&e.jsx("div",{className:"absolute bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 md:w-1.5 md:h-1.5 rounded-full bg-[#6938EF]"})]},r)}),Array.from({length:Math.max(0,42-x-g)}).map((t,s)=>{const r=s+1,n=11===h?0:h+1,a=11===h?m+1:m,o=new Date,i=o.getDate()===r&&o.getMonth()===n&&o.getFullYear()===a;return e.jsxs("div",{className:"w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 relative flex items-center justify-center",children:[e.jsx("div",{className:"text-xs sm:text-sm font-normal text-[#717680]",children:r}),i&&e.jsx("div",{className:"absolute bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 md:w-1.5 md:h-1.5 rounded-full bg-[#A4A7AE]"})]},`next-${s}`)})]})]}),e.jsxs("div",{className:"pt-2 pb-3 md:pb-4 px-3 md:px-4 border-t border-[#E9EAEB] flex flex-col items-stretch sm:items-end gap-3 shrink-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-1 w-full sm:w-auto",children:[e.jsx("div",{className:"flex-1 sm:w-[136px] px-3 py-2 bg-white rounded-lg border border-[#D5D7DA] shadow-sm",children:e.jsx("div",{className:"text-sm sm:text-base font-normal text-[#181D27]",children:i?i.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Select date"})}),e.jsx("div",{className:"flex-1 sm:w-[136px] px-3 py-2 bg-white rounded-lg border border-[#D5D7DA] shadow-sm",children:e.jsx("div",{className:"text-sm sm:text-base font-normal text-[#181D27] text-center",children:c})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsx("button",{onClick:r,className:"w-full sm:w-auto px-[14px] py-[10px] bg-white rounded-lg border border-[#D5D7DA] shadow-sm text-sm font-semibold text-[#414651] hover:bg-slate-50 transition",children:"Cancel"}),e.jsx("button",{onClick:()=>{if(i){const[e,t]=c.split(" "),[s,r]=e.split(":").map(Number);let a=s;"PM"===t&&12!==s&&(a+=12),"AM"===t&&12===s&&(a=0);const o=new Date(i);o.setHours(a,r),n(o)}},className:"w-full sm:w-auto px-[14px] py-[10px] bg-[#6938EF] rounded-lg border-2 border-white shadow-sm text-sm font-semibold text-white hover:bg-[#5d2fd4] transition",children:"Apply"})]})]})]})]})})},X=async(e,t)=>{try{const r=localStorage.getItem("accessToken");if(!r){const e=a("Authentication required. Please login again.",void 0,"Authentication required. Please login again.");throw new Error(e)}const n=localStorage.getItem("organizationUuid");if(!n){const e=a("Organization UUID is missing. Please create or select an organization first.",void 0,"Organization UUID is missing. Please create or select an organization first.");throw new Error(e)}let d=t;if(!d){const e=localStorage.getItem("created-event");if(e)try{d=JSON.parse(e).uuid}catch{}}if(!d){const e=a("Event UUID is required. Please select an event first.",void 0,"Event UUID is required. Please select an event first.");throw new Error(e)}const u=new FormData;u.append("file",e),u.append("event_uuid",d);const m=await fetch(o.USER_MANAGEMENT.UPLOAD_USER,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-Organization":n},credentials:"include",body:u});if(!m||!m.ok){if(!m){const e=i(null);throw new Error(e)}try{const e=await m.text();let t=null;try{t=e?JSON.parse(e):null}catch{if(e&&e.trim()){const t=a(e.trim(),m,"Failed to upload attendees. Please try again.");throw new Error(t)}}if(t){const e=a(t,m,"Failed to upload attendees. Please try again.");throw new Error(e)}const s=a(null,m,"Failed to upload attendees. Please try again.");throw new Error(s)}catch(s){if(s instanceof Error&&(s.message.includes("Failed to upload")||s.message.includes("Cannot connect")))throw s;const e=a(null,m,"Failed to upload attendees. Please try again.");throw new Error(e)}}let h;try{h=await m.json()}catch{const e=l("Invalid response from server. Please try again.");throw new Error(e)}if("error"===h.status){const e=a(h,void 0,"Failed to upload attendees. Please try again.");throw new Error(e)}return"success"===h.status&&c.success(h.message||"Users uploaded successfully"),h}catch(r){if(r instanceof TypeError&&r.message.includes("fetch"))throw r.message.includes("Cannot connect")||i(),new Error(r.message||"Network error occurred");if(r instanceof Error&&(r.message.includes("Cannot connect")||r.message.includes("Invalid response")||r.message.includes("Authentication required")||r.message.includes("Organization UUID")||r.message.includes("Event UUID")||r.message.includes("Failed to upload")))throw r;const e=r instanceof Error?r.message:"Failed to upload attendees. Please try again.";throw a(e,void 0,"Failed to upload attendees. Please try again."),new Error(e)}},V=async e=>{try{const s=localStorage.getItem("accessToken");if(!s){const e=a("Authentication required. Please login again.",void 0,"Authentication required. Please login again.");throw new Error(e)}const r=localStorage.getItem("organizationUuid");if(!r){const e=a("Organization UUID is missing. Please create or select an organization first.",void 0,"Organization UUID is missing. Please create or select an organization first.");throw new Error(e)}if(!e){const e=a("Event UUID is required.",void 0,"Event UUID is required.");throw new Error(e)}const n=await fetch(o.USER_MANAGEMENT.LIST(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`,"X-Organization":r},credentials:"include"});if(!n||!n.ok){if(!n){const e=i(null);throw new Error(e)}try{const e=await n.text();let t=null;try{t=e?JSON.parse(e):null}catch{if(e&&e.trim()){const t=a(e.trim(),n,"An error occurred. Please try again.");throw new Error(t)}}if(t){const e=a(t,n,"An error occurred. Please try again.");throw new Error(e)}const s=a(null,n,"An error occurred. Please try again.");throw new Error(s)}catch(t){if(t instanceof Error&&(t.message.includes("An error occurred")||t.message.includes("Cannot connect")||t.message.includes("Failed to")))throw t;const e=a(null,n,"An error occurred. Please try again.");throw new Error(e)}}let c;try{c=await n.json()}catch{const e=l("Invalid response from server. Please try again.");throw new Error(e)}if("error"===c.status){const e=a(c,void 0,"Failed to fetch attendees. Please try again.");throw new Error(e)}let d,u=c.data;if(!u)return[];if(Array.isArray(u))d=u;else{if("object"!=typeof u||!u.data||!Array.isArray(u.data))return[];d=u.data}return d}catch(s){if(s instanceof TypeError&&s.message.includes("fetch"))throw s.message.includes("Cannot connect")||i(),new Error(s.message||"Network error occurred");if(s instanceof Error&&(s.message.includes("Cannot connect")||s.message.includes("Invalid response")||s.message.includes("Authentication required")||s.message.includes("Organization UUID")||s.message.includes("Event UUID")||s.message.includes("Failed to")))throw s;const e=s instanceof Error?s.message:"Failed to fetch attendees. Please try again.";throw a(e,void 0,"Failed to fetch attendees. Please try again."),new Error(e)}},W=async e=>{try{const r=localStorage.getItem("accessToken");if(!r){const e=a("Authentication required. Please login again.",void 0,"Authentication required. Please login again.");throw new Error(e)}const n=localStorage.getItem("organizationUuid");if(!n){const e=a("Organization UUID is missing. Please create or select an organization first.",void 0,"Organization UUID is missing. Please create or select an organization first.");throw new Error(e)}if(!e.event_uuid){const e=a("Event UUID is required.",void 0,"Event UUID is required.");throw new Error(e)}if(!e.name||!e.name.trim()){const e=a("Tag name is required.",void 0,"Tag name is required.");throw new Error(e)}const d={event_uuid:e.event_uuid,name:e.name.trim(),description:e.description||"",is_active:void 0===e.is_active||e.is_active};0;const u=await fetch(o.TAGS.CREATE,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,"X-Organization":n},credentials:"include",body:JSON.stringify(d)});if(!u||!u.ok){if(!u){const e=i(null);throw new Error(e)}try{const e=await u.text();let s=null;try{s=e?JSON.parse(e):null}catch(t){if(e&&e.trim()){const t=a(e.trim(),u,"Failed to create tag. Please try again.");throw new Error(t)}}if(s){const e=a(s,u,"Failed to create tag. Please try again.");throw new Error(e)}const r=a(null,u,"Failed to create tag. Please try again.");throw new Error(r)}catch(s){if(s instanceof Error&&(s.message.includes("Failed to create")||s.message.includes("Cannot connect")||s.message.includes("Failed to")))throw s;const e=a(null,u,"Failed to create tag. Please try again.");throw new Error(e)}}let m;try{const e=await u.text();0,m=e?JSON.parse(e):{}}catch(s){const e=l("Invalid response from server. Please try again.");throw new Error(e)}if("error"===(null==m?void 0:m.status)){const e=a(m,void 0,"Failed to create tag. Please try again.");throw new Error(e)}if("success"===(null==m?void 0:m.status)&&c.success(m.message||"Tag created successfully"),null==m?void 0:m.data)return m.data;if(m&&"object"==typeof m&&(m.uuid||m.id||m.name))return c.success("Tag created successfully"),m;throw new Error("No data returned from server")}catch(r){if(r instanceof TypeError&&r.message.includes("fetch"))throw r.message.includes("Cannot connect")||i(),new Error(r.message||"Network error occurred");if(r instanceof Error&&(r.message.includes("Cannot connect")||r.message.includes("Invalid response")||r.message.includes("Authentication required")||r.message.includes("Organization UUID")||r.message.includes("Event UUID")||r.message.includes("Tag name")||r.message.includes("No data returned")||r.message.includes("Failed to")))throw r;const e=r instanceof Error?r.message:"Failed to create tag. Please try again.";throw a(e,void 0,"Failed to create tag. Please try again."),new Error(e)}},Y=async e=>{var t,s;try{const c=localStorage.getItem("accessToken");if(!c){const e=a("Authentication required. Please login again.",void 0,"Authentication required. Please login again.");throw new Error(e)}const d=localStorage.getItem("organizationUuid");if(!d){const e=a("Organization UUID is missing. Please create or select an organization first.",void 0,"Organization UUID is missing. Please create or select an organization first.");throw new Error(e)}if(!e){const e=a("Event UUID is required.",void 0,"Event UUID is required.");throw new Error(e)}const u=o.TAGS.LIST(e);0;const m=await fetch(u,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`,"X-Organization":d},credentials:"include"});if(!m||!m.ok){if(!m){const e=i(null);throw new Error(e)}if(404===m.status)return[];try{const e=await m.text();let t=null;try{t=e?JSON.parse(e):null}catch(r){if(e&&e.trim()){const t=a(e.trim(),m,"An error occurred. Please try again.");throw new Error(t)}}if(t){const e=a(t,m,"An error occurred. Please try again.");throw new Error(e)}const s=a(null,m,"An error occurred. Please try again.");throw new Error(s)}catch(n){if(n instanceof Error&&(n.message.includes("An error occurred")||n.message.includes("Cannot connect")||n.message.includes("Failed to")))throw n;const e=a(null,m,"An error occurred. Please try again.");throw new Error(e)}}let h;try{const e=await m.text();if(!e||""===e.trim())return[];h=JSON.parse(e)}catch(n){const e=l("Invalid response from server. Please try again.");throw new Error(e)}if("error"===h.status){const e=a(h,void 0,"Failed to fetch tags. Please try again.");throw new Error(e)}let g=null;if("success"===(null==h?void 0:h.status)&&(Array.isArray(h.data)?g=h.data:Array.isArray(null==(t=null==h?void 0:h.data)?void 0:t.results)?g=h.data.results:Array.isArray(null==h?void 0:h.results)&&(g=h.results)),!g&&Array.isArray(h)&&(g=h),!g&&Array.isArray(null==h?void 0:h.data)&&(g=h.data),!g&&Array.isArray(null==h?void 0:h.results)&&(g=h.results),!g&&Array.isArray(null==(s=null==h?void 0:h.data)?void 0:s.results)&&(g=h.data.results),!g)return[];if(!Array.isArray(g))return[];return g.map(e=>({uuid:(null==e?void 0:e.uuid)??(null==e?void 0:e.id)??"",name:(null==e?void 0:e.name)??(null==e?void 0:e.title)??"",description:(null==e?void 0:e.description)??"",is_active:(null==e?void 0:e.is_active)??(null==e?void 0:e.isActive)??!0})).filter(e=>Boolean(e.uuid)&&Boolean(e.name))}catch(c){if(c instanceof TypeError&&c.message.includes("fetch"))throw c.message.includes("Cannot connect")||i(),new Error(c.message||"Network error occurred");if(c instanceof Error&&(c.message.includes("Cannot connect")||c.message.includes("Invalid response")||c.message.includes("Authentication required")||c.message.includes("Organization UUID")||c.message.includes("Event UUID")||c.message.includes("Failed to")))throw c;const e=c instanceof Error?c.message:"Failed to fetch tags. Please try again.";throw a(e,void 0,"Failed to fetch tags. Please try again."),new Error(e)}},K=async e=>{try{const s=localStorage.getItem("accessToken"),r=localStorage.getItem("organizationUuid");if(!s){const e=a("Authentication required. Please login again.",void 0,"Authentication required. Please login again.");throw new Error(e)}if(!r){const e=a("Organization UUID is missing. Please create or select an organization first.",void 0,"Organization UUID is missing. Please create or select an organization first.");throw new Error(e)}if(!e){throw new Error("Event UUID is required.")}const n=await fetch(o.COMMUNICATION.LIST(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`,"X-Organization":r},credentials:"include"});if(!n||!n.ok){if(!n){const e=i(null);throw new Error(e)}if(404===n.status)return[];try{const e=await n.json(),t=a(e,n,"Failed to fetch communications. Please try again.");throw new Error(t)}catch(t){if(t instanceof Error&&t.message.includes("JSON")){const e=a(null,n,"Failed to fetch communications. Please try again.");throw new Error(e)}throw t}}let c;try{c=await n.json()}catch{const e=l("Invalid response from server. Please try again.");throw new Error(e)}if("error"===c.status){const e=a(c,void 0,"Failed to fetch communications. Please try again.");throw new Error(e)}return"success"===c.status&&c.data&&Array.isArray(c.data)?c.data:[]}catch(s){if(s instanceof TypeError&&s.message.includes("fetch")){const e=i();throw new Error(e)}if(s instanceof Error)throw s;throw new Error("An unexpected error occurred while fetching communications.")}},Q=({onCancel:t,onSave:r,onSend:n,macros:u=[],initialSubject:m="",initialMessage:h="",type:g="email"})=>{const[p,x]=s.useState("late-message"),[f,b]=s.useState(m||""),[w,v]=s.useState(h),[y,j]=s.useState(!0),[N,z]=s.useState(""),[O,R]=s.useState(!1),[B,q]=s.useState(!1),[H,$]=s.useState("#000000"),[X,V]=s.useState(!1),[W,K]=s.useState({top:0,left:0}),[Q,Z]=s.useState(!1),[ee,te]=s.useState(!1),[se,re]=s.useState(!1),[ne,ae]=s.useState(!1),[oe,ie]=s.useState(!1),[le,ce]=s.useState(!1),[de,ue]=s.useState("ANY"),[me,he]=s.useState([{id:"1",field:"Group",operator:"is",value:"Speakers"}]),[ge,pe]=s.useState([]),{createdEvent:xe}=d(),fe=s.useRef(null),be=s.useRef(null),we=s.useRef(null),ve=s.useRef(null),ye=s.useRef(null),je=s.useRef(null);s.useEffect(()=>{je.current&&h&&je.current.innerHTML!==h&&(je.current.innerHTML=h)},[]),s.useEffect(()=>{(async()=>{const e=null==xe?void 0:xe.uuid;if(e)try{const t=(await Y(e)).filter(e=>!1!==e.is_active).map(e=>({uuid:e.uuid,name:e.name}));pe(t)}catch(t){pe([])}else pe([])})()},[null==xe?void 0:xe.uuid]);const Ne=s.useMemo(()=>{const e=[];return me.forEach(t=>{"Group"===t.field&&"is"===t.operator&&t.value&&(e.includes(t.value)||e.push(t.value))}),e},[me]),Ee=[["#000000","#1E3A8A","#166534","#374151","#6B7280","#9CA3AF","#FFFFFF"],["#10B981","#3B82F6","#7F56D9","#EC4899","#EF4444","#F59E0B"]],Ce=(e,t)=>{var s,r;if(!je.current)return;document.activeElement!==je.current&&je.current.focus();const n=window.getSelection();if("foreColor"===e&&(!n||0===n.rangeCount||0===n.toString().length)){const e=document.createRange(),t=window.getSelection();if(t&&je.current)if(t.anchorNode){const n=t.anchorNode.nodeType===Node.TEXT_NODE?t.anchorNode:je.current;if(n){const o=t.anchorOffset||0;try{e.setStart(n,Math.min(o,(null==(s=n.textContent)?void 0:s.length)||0)),e.setEnd(n,Math.min(o,(null==(r=n.textContent)?void 0:r.length)||0)),t.removeAllRanges(),t.addRange(e)}catch(a){e.selectNodeContents(je.current),e.collapse(!1),t.removeAllRanges(),t.addRange(e)}}}else e.selectNodeContents(je.current),e.collapse(!1),t.removeAllRanges(),t.addRange(e)}if(!("justifyLeft"!==e&&"justifyCenter"!==e&&"justifyRight"!==e&&"justifyFull"!==e||n&&0!==n.rangeCount&&0!==n.toString().length)){const e=document.createRange(),t=window.getSelection();if(t&&je.current){let s=je.current;for(t.anchorNode&&(s=t.anchorNode.nodeType===Node.TEXT_NODE?t.anchorNode.parentElement||je.current:t.anchorNode);s&&s!==je.current&&!["P","DIV","H1","H2","H3","H4","H5","H6","LI"].includes(s.tagName);)s=s.parentElement||je.current;s&&(e.selectNodeContents(s),t.removeAllRanges(),t.addRange(e))}}try{document.execCommand(e,!1,t)&&(je.current&&v(je.current.innerHTML),setTimeout(()=>{Se()},10))}catch(o){}},Se=()=>{if(je.current){const t=document.activeElement;if(t&&"subject"===t.id)return;const s=document.activeElement===je.current;if(!s){const e=document.getElementById("subject");if(e&&(e===t||e.contains(t)))return;je.current.focus()}try{Z(document.queryCommandState("bold")),te(document.queryCommandState("italic")),re(document.queryCommandState("underline"))}catch(e){}if(!s){const e=window.getSelection();e&&e.rangeCount}}},Ae=()=>{setTimeout(()=>{const e=document.activeElement;if(e&&"subject"===e.id)return;const t=window.getSelection(),s=je.current;if(s)if(document.activeElement===s&&Se(),t&&t.toString().length>0){const e=t.anchorNode,r=t.focusNode;if(s&&(s.contains(e)||s.contains(r)||e===s||r===s)){const e=t.getRangeAt(0).getBoundingClientRect(),r=s.getBoundingClientRect();K({top:e.top-r.top-40,left:e.left-r.left+e.width/2}),V(!0)}}else V(!1)},10)};s.useEffect(()=>{const e=je.current;if(e)return e.addEventListener("mouseup",Ae),e.addEventListener("keyup",Ae),e.addEventListener("selectionchange",Ae),()=>{e.removeEventListener("mouseup",Ae),e.removeEventListener("keyup",Ae),e.removeEventListener("selectionchange",Ae)}},[]),s.useEffect(()=>{const e=e=>{var t,s;const r=e.target,n=document.getElementById("subject");n&&(n===r||n.contains(r))||(B&&fe.current&&!fe.current.contains(r)&&be.current&&!be.current.contains(r)&&(q(!1),ve.current=null),!X||(null==(t=je.current)?void 0:t.contains(r))||(null==(s=we.current)?void 0:s.contains(r))||V(!1),O&&ye.current&&!ye.current.contains(r)&&R(!1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[B,X,O]);const De=(e,t)=>{t&&(t.preventDefault(),t.stopPropagation()),$(e),q(!1),je.current?requestAnimationFrame(()=>{var t;const s=je.current;if(!s)return void(ve.current=null);s.focus();const r=window.getSelection();let n=null;if(ve.current)try{const e=ve.current.cloneRange();s.contains(e.commonAncestorContainer)?n=e:ve.current=null}catch(a){ve.current=null}if(!n&&r&&r.rangeCount>0){const e=r.getRangeAt(0);e&&s.contains(e.commonAncestorContainer)&&(n=e)}if(!n){n=document.createRange();const e=window.getSelection();if(e&&e.anchorNode&&s.contains(e.anchorNode))try{if(e.anchorNode.nodeType===Node.TEXT_NODE){const s=Math.min(e.anchorOffset||0,(null==(t=e.anchorNode.textContent)?void 0:t.length)||0);n.setStart(e.anchorNode,s),n.setEnd(e.anchorNode,s)}else{let e=document.createTreeWalker(s,NodeFilter.SHOW_TEXT,null).nextNode();e?(n.setStart(e,0),n.setEnd(e,0)):(n.selectNodeContents(s),n.collapse(!1))}}catch(a){n.selectNodeContents(s),n.collapse(!1)}else n.selectNodeContents(s),n.collapse(!1)}if(n&&s.contains(n.commonAncestorContainer)){r&&(r.removeAllRanges(),r.addRange(n));try{if(n.toString().trim().length>0){const t=document.createElement("span");t.style.color=e,t.style.setProperty("color",e,"important");const a=n.extractContents();if(a.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(;a.firstChild;)t.appendChild(a.firstChild);else a&&t.appendChild(a);n.insertNode(t),t.setAttribute("data-color-applied",e),t.setAttribute("data-preserve-color","true");const o=`rgb(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)})`,i=()=>{const s=t.style.color||window.getComputedStyle(t).color;("rgb(0, 0, 0)"===s||s!==o&&s!==e&&s!==`rgb(${parseInt(e.slice(1,3),16)},${parseInt(e.slice(3,5),16)},${parseInt(e.slice(5,7),16)})`)&&(t.style.setProperty("color",e,"important"),t.style.color=e)},l=new MutationObserver(e=>{e.forEach(e=>{"attributes"!==e.type||"style"!==e.attributeName&&"class"!==e.attributeName||i()}),i()});l.observe(t,{attributes:!0,attributeFilter:["style","class"],childList:!0,subtree:!0});const c=new MutationObserver(()=>{s.contains(t)&&i()});c.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class"]}),i();const d=setInterval(()=>{s.contains(t)?i():(clearInterval(d),l.disconnect(),c.disconnect())},100),u=()=>{s.contains(t)&&i()};s.addEventListener("input",u);const m=document.createRange();m.selectNodeContents(t),r&&(r.removeAllRanges(),r.addRange(m));s.contains(t);setTimeout(()=>{i();s.innerHTML,window.getComputedStyle(t).color;v(s.innerHTML)},100)}else{const t=n.commonAncestorContainer;if(t.nodeType===Node.TEXT_NODE&&t.textContent){const s=t,a=n.startOffset,o=s.textContent||"",i=o.substring(0,a),l=o.substring(a),c=document.createTextNode(i),d=document.createTextNode(l),u=document.createElement("span");u.style.color=e,u.textContent="​";const m=s.parentNode;if(m){i&&m.insertBefore(c,s),m.insertBefore(u,s),l&&m.insertBefore(d,s),m.removeChild(s);const e=document.createRange();e.setStartAfter(u),e.collapse(!0),r&&(r.removeAllRanges(),r.addRange(e))}}else{const t=document.createElement("span");t.style.color=e,t.textContent="​",n.insertNode(t);const s=document.createRange();s.setStartAfter(t),s.collapse(!0),r&&(r.removeAllRanges(),r.addRange(s))}v(s.innerHTML)}}catch(a){try{document.execCommand("foreColor",!1,e),v(s.innerHTML)}catch(o){}}ve.current=null}else ve.current=null}):ve.current=null},Te=(e,t,s)=>{e.preventDefault(),Ce(t,s)};return e.jsxs("div",{className:"space-y-6 px-4 pb-12 pt-28 md:px-10 lg:px-16 -mt-24 min-h-screen flex flex-col",children:[e.jsx("style",{children:"\n        .broadcast-editor-content ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; }\n        .broadcast-editor-content ol { list-style-type: decimal; padding-left: 1.5em; margin-bottom: 1em; }\n        .broadcast-editor-content b, .broadcast-editor-content strong { font-weight: bold; }\n        .broadcast-editor-content i, .broadcast-editor-content em { font-style: italic; }\n        .broadcast-editor-content u { text-decoration: underline; }\n        .broadcast-editor-content p { margin-bottom: 0.5em; }\n        .composer-container { max-height: calc(100vh - 200px); }\n        @media (max-height: 1080px) {\n          .composer-container { max-height: calc(100vh - 300px); }\n        }\n        .composer-editor { min-height: 400px; max-height: none; }\n        @media (max-height: 1080px) {\n          .composer-editor { min-height: 200px; max-height: 250px; }\n        }\n      "}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between ",children:[e.jsx("h1",{className:"text-[26px] font-semibold  text-primary-dark mb-4 ",children:"Communication"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{type:"button",variant:"primary",size:"md",onClick:()=>ae(!0),iconTrailing:e.jsx(E,{className:"h-4 w-4"}),children:"Send"}),e.jsx(_,{type:"button",variant:"secondary",size:"md",onClick:()=>ie(!0),iconTrailing:e.jsx(C,{className:"h-4 w-4"}),children:"Schedule"})]})]}),e.jsxs("div",{className:"rounded-xl bg-white overflow-hidden flex flex-col composer-container",children:[e.jsxs("div",{className:"flex gap-6 border-b border-slate-200 flex-shrink-0",children:[e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onClick:()=>x("late-message"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative whitespace-nowrap "+("late-message"===p?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Late Message"}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onClick:()=>x("settings"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative whitespace-nowrap "+("settings"===p?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Settings"})]}),e.jsx("div",{className:"p-6 border border-slate-200 flex-1 flex flex-col overflow-y-auto min-h-0",children:"late-message"===p?e.jsx("div",{className:"space-y-4 flex-1 flex flex-col min-h-0",children:y?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`group relative flex flex-col w-full rounded-md border ${"email"===g&&f.length>60?"border-orange-300":"border-slate-300"} bg-slate-50 transition-all`,onClick:e=>{const t=e.target;if("LABEL"===t.tagName||t===e.currentTarget&&"INPUT"!==t.tagName){const e=document.getElementById("subject");e&&document.activeElement!==e&&setTimeout(()=>{e.focus()},0)}},children:[e.jsxs("div",{className:"flex items-center px-3 pt-2.5",children:[e.jsx("label",{htmlFor:"subject",className:"text-sm font-semibold text-slate-700 mr-2 cursor-text shrink-0",children:"push-notification"===g?"Title:":"Subject:"}),e.jsx("input",{id:"subject",type:"text",placeholder:"Title of your message",value:f,onChange:e=>{const t="push-notification"===g?50:120;e.target.value.length<=t&&b(e.target.value)},onMouseDown:e=>{e.stopPropagation();const t=e.currentTarget;setTimeout(()=>{t&&t.focus()},0)},onClick:e=>{e.stopPropagation();const t=e.currentTarget;t&&t.focus()},onFocus:e=>{const t=e.target;t&&document.activeElement!==t&&t.focus()},tabIndex:0,className:"flex-1 bg-transparent border-none p-0 text-sm text-slate-900 focus:ring-0 focus:outline-none placeholder-slate-400",autoComplete:"off"})]}),e.jsxs("div",{className:"px-3 pb-1.5 flex items-center gap-2 min-h-[20px]",children:["email"===g&&f.length>60&&e.jsxs("div",{className:"group/warning relative flex items-center",children:[e.jsx(S,{className:"h-3 w-3 text-orange-500"}),e.jsxs("div",{className:"absolute bottom-full left-0 mb-2 hidden w-max rounded bg-slate-900 px-2 py-1 text-xs text-white shadow-lg group-hover/warning:block z-10",children:["May be truncated on mobile",e.jsx("div",{className:"absolute -bottom-1 left-1 h-2 w-2 rotate-45 bg-slate-900"})]})]}),e.jsx("span",{className:"text-[10px] "+("email"===g&&f.length>60||"push-notification"===g&&f.length>=50?"text-orange-500 font-medium":"text-slate-400"),children:"push-notification"===g?50-f.length+" characters left":120-f.length+" characters left"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5  border-slate-200 pb-3",children:[e.jsxs("div",{className:"relative",ref:ye,children:[e.jsxs(_,{type:"button",variant:"secondary",size:"sm",onClick:()=>R(!O),iconTrailing:e.jsx("svg",{className:"h-4 w-4 transition-transform "+(O?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),children:["{ }"," Insert"]}),O&&u.length>0&&e.jsx("div",{className:"absolute left-0 top-full z-50 mt-1 max-h-60 w-50 overflow-y-auto rounded-md border border-slate-200 bg-white shadow-lg",children:u.map(t=>{const s=t.macro.replace(/[{}]/g,"");return e.jsx("button",{type:"button",onClick:()=>(e=>{const t=e||N;if(t&&je.current){const e=`{{${t}}}`;je.current.focus();const s=window.getSelection();if(s&&s.rangeCount>0){const t=s.getRangeAt(0);if(je.current.contains(t.commonAncestorContainer)){t.deleteContents();const r=document.createTextNode(e);t.insertNode(r),t.setStartAfter(r),t.setEndAfter(r),s.removeAllRanges(),s.addRange(t)}else je.current.innerHTML+=e}else je.current.innerHTML+=e;v(je.current.innerHTML),z(""),R(!1)}})(s),className:"w-full px-4 py-2 text-left text-sm text-slate-700 hover:bg-slate-50 focus:bg-slate-50 focus:outline-none transition-colors",children:e.jsx("div",{className:"text-xs text-slate-500",children:t.macro})},t.id)})})]}),e.jsxs("select",{className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",defaultValue:"Inter",children:[e.jsx("option",{value:"Inter",children:"T Inter"}),e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Helvetica",children:"Helvetica"}),e.jsx("option",{value:"Times",children:"Times New Roman"})]}),e.jsx("div",{className:"h-5 w-px bg-slate-300"}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"bold"),className:"h-8 w-8 p-0 "+(Q?"bg-slate-200 text-slate-900":""),title:"Bold",iconLeading:e.jsx(A,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"italic"),className:"h-8 w-8 p-0 "+(ee?"bg-slate-200 text-slate-900":""),title:"Italic",iconLeading:e.jsx(D,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"underline"),className:"h-8 w-8 p-0 "+(se?"bg-slate-200 text-slate-900":""),title:"Underline",iconLeading:e.jsx(T,{className:"h-4 w-4"})}),e.jsx("div",{className:"h-5 w-px bg-slate-300"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{ref:fe,type:"button",onMouseDown:e=>{if(e.preventDefault(),je.current){je.current.focus();const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0);je.current.contains(t.commonAncestorContainer)&&(ve.current=t.cloneRange())}}},onClick:e=>{var t;if(e.preventDefault(),e.stopPropagation(),je.current){je.current.focus();const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0);je.current.contains(t.commonAncestorContainer)&&(ve.current=t.cloneRange())}else if(!ve.current){const e=document.createRange(),r=window.getSelection();if(r&&r.anchorNode&&je.current.contains(r.anchorNode))try{const s=r.anchorNode.nodeType===Node.TEXT_NODE?r.anchorNode:je.current,n=r.anchorOffset||0,a=(null==(t=s.textContent)?void 0:t.length)||0;e.setStart(s,Math.min(n,a)),e.setEnd(s,Math.min(n,a)),ve.current=e}catch(s){e.selectNodeContents(je.current),e.collapse(!1),ve.current=e}else e.selectNodeContents(je.current),e.collapse(!1),ve.current=e}}q(!B)},className:"flex h-8 w-8 items-center justify-center rounded hover:bg-slate-100",title:"Text Color",children:e.jsx("div",{className:"h-3.5 w-3.5 rounded-full",style:{backgroundColor:H}})}),B&&e.jsxs("div",{ref:be,className:"color-picker-popup absolute left-0 top-full z-50 mt-1 rounded-lg border border-slate-200 bg-white p-3 shadow-lg",onMouseDown:e=>{e.preventDefault()},children:[e.jsx("div",{className:"grid grid-cols-7 gap-2",children:Ee[0].map((t,s)=>e.jsx("button",{type:"button",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),De(t,e)},onClick:e=>{e.preventDefault(),e.stopPropagation(),De(t,e)},className:"h-8 w-8 rounded border-2 transition "+(H===t?"border-primary ring-2 ring-primary/20":"border-slate-300"),style:{backgroundColor:t},title:t},s))}),e.jsx("div",{className:"mt-2 grid grid-cols-6 gap-2",children:Ee[1].map((t,s)=>e.jsx("button",{type:"button",onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),De(t,e)},onClick:e=>{e.preventDefault(),e.stopPropagation(),De(t,e)},className:"h-8 w-8 rounded border-2 transition "+(H===t?"border-primary ring-2 ring-primary/20":"border-slate-300"),style:{backgroundColor:t},title:t},s))}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50",children:"Custom"}),e.jsx("input",{type:"text",value:H,onChange:e=>$(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),De(H,e))},onBlur:()=>{/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(H)&&De(H)},className:"flex-1 rounded-md border border-slate-300 px-2 py-1.5 text-xs text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"#7F56D9"})]})]})]}),e.jsx("div",{className:"h-5 w-px bg-slate-300"}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"justifyLeft"),className:"h-8 w-8 p-0",title:"Align Left",iconLeading:e.jsx(k,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"justifyCenter"),className:"h-8 w-8 p-0",title:"Align Center",iconLeading:e.jsx(M,{className:"h-4 w-4"})}),e.jsx("div",{className:"h-5 w-px bg-slate-300"}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"insertUnorderedList"),className:"h-8 w-8 p-0",title:"Bullet List",iconLeading:e.jsx(I,{className:"h-4 w-4"})}),e.jsx("div",{className:"h-5 w-px bg-slate-300"}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>{e.preventDefault();const t=prompt("Enter URL:");t&&Ce("createLink",t)},className:"h-8 w-8 p-0",title:"Insert Link",iconLeading:e.jsx(P,{className:"h-4 w-4"})}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>{e.preventDefault();const t=prompt("Enter image URL:");t&&Ce("insertImage",t)},className:"h-8 w-8 p-0",title:"Insert Image",iconLeading:e.jsx(F,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx("div",{ref:je,contentEditable:!0,onInput:e=>{const t=e.currentTarget.innerHTML;v(t),setTimeout(()=>Se(),10)},onKeyUp:()=>{Se()},onBlur:e=>{const t=e.nativeEvent.relatedTarget;t&&"subject"===t.id||Se()},onFocus:()=>{Se()},className:"broadcast-editor-content composer-editor w-full -mt-2 rounded-md border border-slate-300 bg-white px-4 py-3 text-sm text-slate-900 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20 overflow-y-auto",style:{whiteSpace:"pre-wrap",lineHeight:"1.5"},"data-placeholder":"",suppressContentEditableWarning:!0}),X&&e.jsxs("div",{ref:we,className:"absolute z-50 flex items-center gap-1 rounded-lg border border-slate-200 bg-slate-900 p-1.5 shadow-lg",style:{top:`${W.top}px`,left:`${W.left}px`,transform:"translateX(-50%)"},onMouseDown:e=>e.preventDefault(),children:[e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"bold"),className:"h-7 w-7 p-0 bg-slate-900 text-white hover:bg-slate-700 "+(Q?"bg-slate-700":""),title:"Bold",iconLeading:e.jsx(A,{className:"h-3.5 w-3.5"})}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"italic"),className:"h-7 w-7 p-0 bg-slate-900 text-white hover:bg-slate-700 "+(ee?"bg-slate-700":""),title:"Italic",iconLeading:e.jsx(D,{className:"h-3.5 w-3.5"})}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"underline"),className:"h-7 w-7 p-0 bg-slate-900 text-white hover:bg-slate-700 "+(se?"bg-slate-700":""),title:"Underline",iconLeading:e.jsx(T,{className:"h-3.5 w-3.5"})}),e.jsx("div",{className:"h-5 w-px bg-slate-600"}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"justifyLeft"),className:"h-7 w-7 p-0 bg-slate-900 text-white hover:bg-slate-700",title:"Align Left",iconLeading:e.jsx(k,{className:"h-3.5 w-3.5"})}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"justifyCenter"),className:"h-7 w-7 p-0 bg-slate-900 text-white hover:bg-slate-700",title:"Align Center",iconLeading:e.jsx(M,{className:"h-3.5 w-3.5"})}),e.jsx("div",{className:"h-5 w-px bg-slate-600"}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onMouseDown:e=>Te(e,"insertUnorderedList"),className:"h-7 w-7 p-0 bg-slate-900 text-white hover:bg-slate-700",title:"Bullet List",iconLeading:e.jsx(I,{className:"h-3.5 w-3.5"})})]})]}),e.jsxs("div",{className:"mt-auto pt-6 flex justify-end gap-3 border-t border-slate-200",children:[e.jsx(_,{type:"button",variant:"secondary",size:"md",onClick:t,children:"Cancel"}),e.jsx(_,{type:"button",variant:"primary",size:"md",onClick:()=>{r({subject:f,message:w,templateType:"late-message"===p?"late-message":void 0}),j(!1)},children:"Save changes"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b border-slate-200 pb-2 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-slate-900",children:"push-notification"===g?"Title: ":"Subject: "}),e.jsx("span",{className:"font-medium text-slate-900",children:f})]}),"email"===g&&f.length>60&&e.jsx("div",{className:"group relative flex items-center cursor-help",children:e.jsxs("div",{className:"flex items-center gap-1 rounded bg-orange-50 px-2 py-0.5 text-xs font-medium text-orange-700 border border-orange-200",children:["May be truncated on mobile",e.jsx(S,{className:"h-3 w-3"})]})})]}),e.jsx("div",{className:"broadcast-editor-content text-slate-600",dangerouslySetInnerHTML:{__html:w}}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(_,{type:"button",variant:"primary",size:"md",onClick:()=>j(!0),children:"Edit"})})]})}):e.jsxs("div",{className:"space-y-6 h-[calc(100vh-200px)] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 pb-4",children:[e.jsx("h2",{className:"text-base font-semibold text-slate-900",children:"Recipients"}),e.jsx(_,{type:"button",variant:"secondary",size:"sm",disabled:me.length>=ge.length,title:me.length>=ge.length?`Maximum ${ge.length} filter(s) allowed (one per group)`:void 0,onClick:()=>he([...me,{id:Date.now().toString(),field:"Group",operator:"is",value:""}]),iconLeading:e.jsx(U,{className:"h-4 w-4"}),children:"New filter"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm text-slate-700",children:[e.jsx("span",{children:"Matching"}),e.jsx("select",{value:de,onChange:e=>ue(e.target.value),className:"rounded-md border border-slate-300 bg-white px-2 py-1 text-sm font-medium text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:e.jsx("option",{value:"ALL",children:"ALL"})}),e.jsx("span",{children:"of the following filters"})]}),e.jsx("div",{className:"text-sm font-medium text-primary self-end sm:self-auto",children:"400/500"})]}),e.jsx("div",{className:"space-y-3",children:me.map((t,s)=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 p-3 bg-slate-50 rounded-lg sm:bg-transparent sm:p-0",children:[e.jsx("select",{value:t.field,onChange:e=>{const t=[...me];t[s].field=e.target.value,he(t)},className:"w-full sm:w-auto sm:min-w-[140px] rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:e.jsx("option",{value:"Group",children:"Group"})}),e.jsx("select",{value:t.operator,onChange:e=>{const t=[...me];t[s].operator=e.target.value,he(t)},className:"w-full sm:w-[80px] rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:e.jsx("option",{value:"is",children:"is"})}),e.jsx("select",{value:t.value,onChange:e=>{const t=[...me];t[s].value=e.target.value,he(t)},className:"w-full sm:flex-1 rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:0===ge.length?e.jsx("option",{value:"",children:"No groups available"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select a group..."}),ge.filter(e=>{const r=me.filter((e,t)=>t!==s&&e.value&&""!==e.value.trim()).map(e=>e.value);return e.name===t.value||!r.includes(e.name)}).map(t=>e.jsx("option",{value:t.name,children:t.name},t.uuid))]})}),e.jsx(_,{type:"button",variant:"tertiary",size:"sm",onClick:()=>{const e=me.filter(e=>e.id!==t.id);he(e)},className:"self-end sm:self-auto p-1 text-slate-400 hover:text-slate-600",iconLeading:e.jsx(L,{className:"h-4 w-4"})})]},t.id))})]})]})})]}),e.jsx(G,{isOpen:ne,onClose:()=>ae(!1),onSend:async()=>{var e;if(!(null==xe?void 0:xe.uuid))return void c.error("Event UUID is required. Please select an event first.");if(!f.trim())return void c.error("Subject is required.");const t=(null==(e=je.current)?void 0:e.innerHTML)||w;if(!t.trim())return void c.error("Message is required.");const s=[];if(me.forEach(e=>{if("Group"===e.field&&"is"===e.operator&&e.value){const t=ge.find(t=>t.name===e.value);t&&(s.includes(t.uuid)||s.push(t.uuid))}}),0!==s.length){ce(!0);try{await(async e=>{try{const s=localStorage.getItem("accessToken"),r=localStorage.getItem("organizationUuid");if(!s){const e=a("Authentication required. Please login again.",void 0,"Authentication required. Please login again.");throw new Error(e)}if(!r){const e=a("Organization UUID is missing. Please create or select an organization first.",void 0,"Organization UUID is missing. Please create or select an organization first.");throw new Error(e)}if(!e.event_uuid){const e="Event UUID is required.";throw c.error(e),new Error(e)}if(!e.subject||!e.subject.trim()){const e="Subject is required.";throw c.error(e),new Error(e)}if(!e.message||!e.message.trim()){const e="Message is required.";throw c.error(e),new Error(e)}const n=await fetch(o.COMMUNICATION.SEND,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`,"X-Organization":r},credentials:"include",body:JSON.stringify({event_uuid:e.event_uuid,subject:e.subject.trim(),message:e.message.trim(),channel:e.channel,tag_uuids:e.tag_uuids})});if(!n||!n.ok){if(!n){const e=i(null);throw new Error(e)}try{const e=await n.json(),t=a(e,n,"Failed to send communication. Please try again.");throw new Error(t)}catch(t){if(t instanceof Error&&t.message.includes("JSON")){const e=a(null,n,"Failed to send communication. Please try again.");throw new Error(e)}throw t}}let d;try{d=await n.json()}catch{const e=l("Invalid response from server. Please try again.");throw new Error(e)}if("error"===d.status){const e=a(d,void 0,"Failed to send communication. Please try again.");throw new Error(e)}if("success"===d.status&&d.data)return c.success(d.message||`Communication sent successfully to ${d.data.total_recipients} recipient(s)`),d.data;throw new Error("Unexpected response format from server.")}catch(s){if(s instanceof TypeError&&s.message.includes("fetch")){const e=i();throw new Error(e)}if(s instanceof Error)throw s;throw new Error("An unexpected error occurred while sending the communication.")}})({event_uuid:xe.uuid,subject:f.trim(),message:t.trim(),channel:"email"===g?"email":"push-notification",tag_uuids:s}),n&&n({subject:f,message:t}),ae(!1)}catch(r){}finally{ce(!1)}}else c.error("Please select at least one group/tag for recipients in the Settings tab.")},subject:f,message:w,isSending:le,recipients:Ne}),e.jsx(J,{isOpen:oe,onClose:()=>ie(!1),onSchedule:e=>{ie(!1)}})]})},Z=({isOpen:t,onClose:r,onConfirm:a})=>{const[o,i]=s.useState(""),[l,c]=s.useState(""),d=()=>{i(""),c(""),r()};return e.jsx(n,{isVisible:t,onClose:d,title:"Create new macro",width:480,maxWidth:400,borderRadius:16,padding:{top:24,right:24,bottom:24,left:24},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{htmlFor:"macro-name",className:"text-sm font-medium text-slate-700",children:["Macro name ",e.jsx("span",{className:"text-primary",children:"*"})]}),e.jsx("input",{id:"macro-name",type:"text",value:o,onChange:e=>i(e.target.value),placeholder:"Enter macro name",className:"w-full rounded-md border border-slate-300 px-3 py-2 text-sm placeholder:text-slate-400 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{htmlFor:"data-source",className:"text-sm font-medium text-slate-700",children:["Select data source ",e.jsx("span",{className:"text-primary",children:"*"})]}),e.jsxs("select",{id:"data-source",value:l,onChange:e=>c(e.target.value),className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:[e.jsx("option",{value:"",disabled:!0,children:"Select source"}),e.jsx("option",{value:"attendees",children:"Attendees"}),e.jsx("option",{value:"speakers",children:"Speakers"}),e.jsx("option",{value:"sponsors",children:"Sponsors"})]})]})]}),e.jsxs("div",{className:"flex justify-between gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:d,className:"flex-1 rounded-md border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-primary/20",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>{o&&l&&(a({name:o,source:l}),i(""),c(""))},disabled:!o||!l,className:"flex-1 rounded-md bg-primary px-4 py-2 text-sm font-medium text-white hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary/20 disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm"})]})]})})},ee=({eventName:r,isDraft:n,onBackClick:a,userAvatarUrl:o,onCardClick:i,hideNavbarAndSidebar:l=!1})=>{const{eventData:c,createdEvent:g}=d(),p=(null==g?void 0:g.eventName)||(null==c?void 0:c.eventName)||r||"Highly important conference of 2025",x=void 0===n||n,f=s.useMemo(()=>{const t=m.map(e=>({id:e.id,label:e.title,icon:e.icon}));return[{id:"overview",label:"Overview",icon:e.jsx(z,{className:"h-5 w-5"})},{id:"event-website",label:"Event website",icon:e.jsx(O,{className:"h-5 w-5"})},{id:"event-hub",label:"Event Hub",icon:e.jsx(R,{className:"h-5 w-5"}),subItems:t}]},[]),[b,w]=t.useState([]),[v,y]=t.useState(!1),j=async()=>{const e=null==g?void 0:g.uuid;if(e){y(!0);try{const[t,s]=await Promise.all([K(e),Y(e).catch(()=>[])]),r=new Map;s.forEach(e=>{!1!==e.is_active&&r.set(e.uuid,e.name)});const n=t.map(e=>{let t="sent";"scheduled"===e.status||e.scheduled_at?t="scheduled":"draft"===e.status&&(t="draft");const s="email"===e.channel?"email":"notification",n=(e.tag_uuids||[]).map(e=>{const t=r.get(e);return t?{id:e,name:t,variant:"primary"}:null}).filter(e=>null!==e);return{id:String(e.id),title:e.subject||"Untitled",userGroups:n,status:t,type:s,recipients:{sent:e.total_recipients||0,total:e.total_recipients||0},scheduledDate:e.scheduled_at}});w(n)}catch(t){w([])}finally{y(!1)}}else w([])};s.useEffect(()=>{(null==g?void 0:g.uuid)&&j()},[null==g?void 0:g.uuid]);const[N,E]=t.useState(!1),[C,S]=t.useState(!1),[A,D]=t.useState(!1),[T,k]=t.useState(null),[M,I]=t.useState(null),[P,F]=t.useState([{id:"email",macro:"{{email}}",column:"Email"},{id:"last_name",macro:"{{last_name}}",column:"Last Name"},{id:"first_name",macro:"{{first_name}}",column:"First Name"},{id:"event_name",macro:"{{event_name}}",column:"Event Name"}]);return e.jsxs("div",{className:l?"":"min-h-screen overflow-x-hidden bg-white",children:[!l&&e.jsxs(e.Fragment,{children:[e.jsx(u,{eventName:p,isDraft:x,onBackClick:a,onSearchClick:()=>{},onNotificationClick:()=>{},onProfileClick:()=>{},userAvatarUrl:o}),e.jsx(h,{items:f,activeItemId:"communications",onItemClick:e=>{if("event-hub"===e&&a)a();else if("communications"!==e){m.some(t=>t.id===e)&&i&&i(e)}}})]}),e.jsx("div",{className:l?"":"md:pl-[250px]",children:A?e.jsx(Q,{onCancel:()=>{D(!1),k(null),I(null)},onSave:e=>{if(M)w(t=>t.map(t=>t.id===M?{...t,title:e.subject}:t));else{const t=Date.now().toString(),s={id:t,title:e.subject,userGroups:[],status:"draft",type:"email"===T?"email":"notification",recipients:{sent:0,total:0}};w(e=>[...e,s]),I(t)}},onSend:async e=>{await j(),D(!1),k(null),I(null)},macros:P,templateType:"late-message",type:T||"email"}):e.jsx(H,{communications:b,macros:P,onCreateBroadcast:()=>{E(!0)},onCreateMacro:()=>{S(!0)},onEditCommunication:e=>{},isLoading:v,onEditMacro:e=>{},onDeleteMacro:e=>{F(t=>t.filter(t=>t.id!==e))}})}),e.jsx($,{isOpen:N,onClose:()=>E(!1),onSelect:e=>{k(e),E(!1),D(!0),I(null)}}),e.jsx(Z,{isOpen:C,onClose:()=>S(!1),onConfirm:e=>{const t={id:Date.now().toString(),macro:`{{${e.name.toLowerCase()}}}`,column:e.name};F(e=>[...e,t]),S(!1)}})]})},te=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{ee as C,B as S,Y as a,H as b,W as c,te as d,V as f,X as u};
