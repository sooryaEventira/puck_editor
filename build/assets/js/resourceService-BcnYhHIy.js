import{h as e,A as r,b as t,a,s as o}from"./index-BIUVR9mh.js";const n=async o=>{try{const a=localStorage.getItem("accessToken");if(!a){const r=e("Authentication required. Please log in again.",void 0,"Authentication required. Please log in again.");throw new Error(r)}const n=localStorage.getItem("organizationUuid");if(!n){const r=e("Organization UUID is required. Please set up your organization first.",void 0,"Organization UUID is required. Please set up your organization first.");throw new Error(r)}const s={name:o.name,event_uuid:o.event_uuid};o.parent&&(s.parent=o.parent);const i=await fetch(r.RESOURCE.CREATE_FOLDER,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`,"X-Organization":n},body:JSON.stringify(s)}),c=await i.text();if(!i.ok){let r=null;try{r=JSON.parse(c)}catch{}const t=e(r||c,i,"An error occurred. Please try again.");throw new Error(t)}let l,d;try{l=JSON.parse(c)}catch{const e=t("Invalid response format from server. Please try again.");throw new Error(e)}if("success"===l.status&&l.data)d=l.data;else{if(!l.uuid){const e=t("Invalid response format from server. Please try again.");throw new Error(e)}d=l}return d}catch(n){if(n instanceof TypeError&&n.message.includes("fetch"))throw n.message.includes("Cannot connect")||a(),new Error(n.message||"Network error occurred");if(n instanceof Error&&(n.message.includes("Cannot connect")||n.message.includes("Invalid response")||n.message.includes("Authentication required")||n.message.includes("Organization UUID")||n.message.includes("Failed to")))throw n;const r=n instanceof Error?n.message:"An error occurred. Please try again.";throw e(r,void 0,"An error occurred. Please try again."),new Error(r)}},s=async(t,n)=>{try{const a=localStorage.getItem("accessToken");if(!a){const r=e("Authentication required. Please log in again.",void 0,"Authentication required. Please log in again.");throw new Error(r)}const s=localStorage.getItem("organizationUuid");if(!s){const r=e("Organization UUID is required. Please set up your organization first.",void 0,"Organization UUID is required. Please set up your organization first.");throw new Error(r)}if(!n){const r=e("Event UUID is required to delete folder.",void 0,"Event UUID is required to delete folder.");throw new Error(r)}const i=new URL(r.RESOURCE.DELETE_FOLDER(t));i.searchParams.append("event_uuid",n);const c=await fetch(i.toString(),{method:"DELETE",headers:{Authorization:`Bearer ${a}`,"X-Organization":s}});if(!c.ok){const r=await c.text();let t=null;try{t=JSON.parse(r)}catch{}const a=e(t||r,c,"Failed to delete folder. Please try again.");throw new Error(a)}o.success("Folder deleted successfully")}catch(s){if(s instanceof TypeError&&s.message.includes("fetch"))throw s.message.includes("Cannot connect")||a(),new Error(s.message||"Network error occurred");if(s instanceof Error&&(s.message.includes("Cannot connect")||s.message.includes("Authentication required")||s.message.includes("Organization UUID")||s.message.includes("Event UUID")||s.message.includes("Failed to")))throw s;const r=s instanceof Error?s.message:"Failed to delete folder. Please try again.";throw e(r,void 0,"Failed to delete folder. Please try again."),new Error(r)}},i=async(o,n)=>{try{const a=localStorage.getItem("accessToken");if(!a){const r=e("Authentication required. Please log in again.",void 0,"Authentication required. Please log in again.");throw new Error(r)}const s=localStorage.getItem("organizationUuid");if(!s){const r=e("Organization UUID is required. Please set up your organization first.",void 0,"Organization UUID is required. Please set up your organization first.");throw new Error(r)}if(!o){const r=e("Event UUID is required to fetch folders.",void 0,"Event UUID is required to fetch folders.");throw new Error(r)}const i=await fetch(r.RESOURCE.LIST_FOLDERS(o,n),{method:"GET",headers:{Authorization:`Bearer ${a}`,"X-Organization":s}});if(!i.ok){const r=await i.text();let t=null;try{t=JSON.parse(r)}catch{}const a=e(t||r,i,"An error occurred. Please try again.");throw new Error(a)}const c=await i.text();let l,d;try{l=JSON.parse(c)}catch{const e=t("Invalid response format from server. Please try again.");throw new Error(e)}if("success"===l.status&&l.data&&Array.isArray(l.data))d=l.data;else if(Array.isArray(l))d=l;else{if(!l.results||!Array.isArray(l.results))return[];d=l.results}return d}catch(s){if(s instanceof TypeError&&s.message.includes("fetch"))throw s.message.includes("Cannot connect")||a(),new Error(s.message||"Network error occurred");if(s instanceof Error&&(s.message.includes("Cannot connect")||s.message.includes("Invalid response")||s.message.includes("Authentication required")||s.message.includes("Organization UUID")||s.message.includes("Event UUID")||s.message.includes("Failed to")))throw s;const r=s instanceof Error?s.message:"Failed to fetch folders. Please try again.";throw e(r,void 0,"Failed to fetch folders. Please try again."),new Error(r)}},c=async e=>{try{const r=[],t=await i(e,null);r.push(...t);const a=async t=>{const o=await i(e,t);r.push(...o);for(const e of o)await a(e.uuid)};for(const e of t)await a(e.uuid);return r}catch(r){throw r}},l=async o=>{try{const a=localStorage.getItem("accessToken");if(!a){const r=e("Authentication required. Please log in again.",void 0,"Authentication required. Please log in again.");throw new Error(r)}const n=localStorage.getItem("organizationUuid");if(!n){const r=e("Organization UUID is required. Please set up your organization first.",void 0,"Organization UUID is required. Please set up your organization first.");throw new Error(r)}if(!o.event_uuid){const r=e("Event UUID is required to upload file.",void 0,"Event UUID is required to upload file.");throw new Error(r)}const s=new FormData;s.append("file",o.file),s.append("event_uuid",o.event_uuid),null!==o.parent&&void 0!==o.parent&&""!==o.parent&&s.append("folder",o.parent);const i=await fetch(r.RESOURCE.UPLOAD_FILE,{method:"POST",headers:{Authorization:`Bearer ${a}`,"X-Organization":n},body:s});if(!i.ok){const r=await i.text();let t=null;try{t=JSON.parse(r)}catch{}const a=e(t||r,i,"Failed to upload file. Please try again.");throw new Error(a)}const c=await i.text();let l,d;try{l=JSON.parse(c)}catch{const e=t("Invalid response format from server. Please try again.");throw new Error(e)}if("success"===l.status&&l.data)d=l.data;else{if(!l.uuid){const e=t("Invalid response format from server. Please try again.");throw new Error(e)}d=l}return d}catch(n){if(n instanceof TypeError&&n.message.includes("fetch"))throw n.message.includes("Cannot connect")||a(),new Error(n.message||"Network error occurred");if(n instanceof Error&&(n.message.includes("Cannot connect")||n.message.includes("Invalid response")||n.message.includes("Authentication required")||n.message.includes("Organization UUID")||n.message.includes("Event UUID")||n.message.includes("Failed to")))throw n;const r=n instanceof Error?n.message:"Failed to upload file. Please try again.";throw e(r,void 0,"Failed to upload file. Please try again."),new Error(r)}},d=async o=>{try{const a=localStorage.getItem("accessToken");if(!a){const r=e("Authentication required. Please log in again.",void 0,"Authentication required. Please log in again.");throw new Error(r)}const n=localStorage.getItem("organizationUuid");if(!n){const r=e("Organization UUID is required. Please set up your organization first.",void 0,"Organization UUID is required. Please set up your organization first.");throw new Error(r)}const s=r.RESOURCE.LIST_FILES(o),i=await fetch(s,{method:"GET",headers:{Authorization:`Bearer ${a}`,"X-Organization":n,"Content-Type":"application/json"}});if(!i.ok){const r=await i.text();let t=null;try{t=JSON.parse(r)}catch{}const a=e(t||r,i,"Failed to fetch files. Please try again.");throw new Error(a)}const c=await i.text();let l,d;try{l=JSON.parse(c)}catch{const e=t("Invalid response format from server. Please try again.");throw new Error(e)}if("success"===l.status&&Array.isArray(l.data))d=l.data;else{if(!Array.isArray(l)){const e=t("Invalid response format from server. Please try again.");throw new Error(e)}d=l}return d}catch(n){if(n instanceof TypeError&&n.message.includes("fetch"))throw n.message.includes("Cannot connect")||a(),new Error(n.message||"Network error occurred");if(n instanceof Error&&(n.message.startsWith("Cannot connect")||n.message.startsWith("Server error")||n.message.startsWith("Invalid response")||n.message.startsWith("Authentication required")||n.message.startsWith("Organization UUID")))throw n;const r=n instanceof Error?n.message:"Failed to fetch files. Please try again.";throw e(r,void 0,"Failed to fetch files. Please try again."),new Error(r)}},u=async(t,n)=>{try{const a=localStorage.getItem("accessToken");if(!a){const r=e("Authentication required. Please log in again.",void 0,"Authentication required. Please log in again.");throw new Error(r)}const s=localStorage.getItem("organizationUuid");if(!s){const r=e("Organization UUID is required. Please set up your organization first.",void 0,"Organization UUID is required. Please set up your organization first.");throw new Error(r)}if(!n){const r=e("Event UUID is required to delete file.",void 0,"Event UUID is required to delete file.");throw new Error(r)}const i=new URL(r.RESOURCE.DELETE_FILE(t));i.searchParams.append("event_uuid",n);const c=await fetch(i.toString(),{method:"DELETE",headers:{Authorization:`Bearer ${a}`,"X-Organization":s}});if(!c.ok){const r=await c.text();let t=null;try{t=JSON.parse(r)}catch{}const a=e(t||r,c,"An error occurred. Please try again.");throw new Error(a)}o.success("File deleted successfully")}catch(s){if(s instanceof TypeError&&s.message.includes("fetch"))throw s.message.includes("Cannot connect")||a(),new Error(s.message||"Network error occurred");if(s instanceof Error&&(s.message.startsWith("Cannot connect")||s.message.startsWith("Server error")||s.message.startsWith("Authentication required")||s.message.startsWith("Organization UUID")||s.message.startsWith("Event UUID")))throw s;const r=s instanceof Error?s.message:"Failed to delete file. Please try again.";throw e(r,void 0,"Failed to delete file. Please try again."),new Error(r)}};export{u as a,i as b,n as c,s as d,d as e,c as f,l as u};
