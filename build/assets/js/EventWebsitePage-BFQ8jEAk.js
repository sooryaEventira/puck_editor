import{j as e}from"./puck-vendor-BeE6vXWX.js";import{r as t}from"./react-vendor-BdxBrZfF.js";import{u as a,f as s,g as i,P as r,E as l}from"./index-Uxn3yAjE.js";import{d as n,E as o}from"./EventHubContent-CwVy8wez.js";import{B as c}from"./Button-Ch-bJN4k.js";import{I as d,c as m,d as x,f as h,E as u,W as p,Y as v,i as b,L as w}from"./icons-vendor-B3tUBqWS.js";const g=({onBackClick:g,userAvatarUrl:j,hideNavbarAndSidebar:f=!1})=>{const{eventData:N,createdEvent:y}=a(),{pages:C,addPage:k,deletePage:S,duplicatePage:z,initializePages:E}=s(),L=t.useMemo(()=>(null==y?void 0:y.eventName)||(null==N?void 0:N.eventName),[null==y?void 0:y.eventName,null==y?void 0:y.uuid,null==N?void 0:N.eventName]),[P,D]=t.useState("website-pages"),[I,$]=t.useState(!1),[M,A]=t.useState(null),[T,U]=t.useState([]),[B,H]=t.useState(!1),[W,V]=t.useState(null),F=t.useCallback(async()=>{if(null==y?void 0:y.uuid){H(!0);try{const e=await i(y.uuid);U(e)}catch(e){}finally{H(!1)}}else U([])},[null==y?void 0:y.uuid]);t.useEffect(()=>{F()},[F]),t.useEffect(()=>{const e=e=>{const{eventUuid:t}=e.detail;t===(null==y?void 0:y.uuid)&&F()};return window.addEventListener("webpage-saved",e),()=>{window.removeEventListener("webpage-saved",e)}},[null==y?void 0:y.uuid,F]),t.useEffect(()=>{if("blank"===new URLSearchParams(window.location.search).get("mode")||"true"===localStorage.getItem("create-from-scratch")){C.length>0&&C.forEach(e=>{var t,a;"welcome"===(null==(t=e.name)?void 0:t.toLowerCase())||null==(a=e.id)||a.toLowerCase(),S(e.id)});try{localStorage.removeItem("website-pages")}catch(e){}0===C.length&&E("scratch")}else C.length>0||E("default-template")},[C.length,E,S]),t.useEffect(()=>{const e=C.filter(e=>"schedule"===e.name.toLowerCase()||"schedule"===e.type);e.length>0&&e.forEach(e=>{S(e.id)})},[C,S]);const O=t.useMemo(()=>{const t=n.map(e=>({id:e.id,label:e.title,icon:e.icon}));return[{id:"overview",label:"Overview",icon:e.jsx(d,{className:"h-5 w-5"})},{id:"event-website",label:"Event website",icon:e.jsx(m,{className:"h-5 w-5"})},{id:"event-hub",label:"Event Hub",icon:e.jsx(x,{className:"h-5 w-5"}),subItems:t}]},[]),G=()=>{if(T.length>0){const e=T[0];window.history.pushState({},"",`/event/website/preview/${e.uuid}`),window.dispatchEvent(new PopStateEvent("popstate"))}},R=()=>{const e=(null==y?void 0:y.uuid)??localStorage.getItem("currentEventUuid");if(!e)return;const t=`${window.location.origin}/events/${e}`;window.open(t,"_blank","noopener,noreferrer")},q=()=>{var t;const a=(null==y?void 0:y.uuid)??localStorage.getItem("currentEventUuid")??"",s=T.map(e=>({id:e.uuid,label:e.name})),i=W??(null==(t=s[0])?void 0:t.id)??null;return e.jsxs("div",{className:"flex flex-col gap-6 min-h-[520px]",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Menu items"}),e.jsx("div",{className:"text-sm text-slate-600",children:"These are the webpages that will appear in the published website navbar."}),e.jsx("div",{className:"space-y-0 border border-slate-200 rounded-lg bg-white",children:B?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:"Loading webpages..."})}):0===s.length?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:"No pages yet. Create pages to see them here."})}):s.map(t=>{const s="welcome"===String(t.label||"").toLowerCase();return e.jsxs("div",{className:"flex items-center justify-between gap-3 py-2 px-4 border-b border-slate-200 last:border-b-0 hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"text-slate-400 cursor-grab select-none","aria-hidden":"true",children:e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M7 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM7 8a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM7 14a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM13 2a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM13 8a2 2 0 1 1 0 4 2 2 0 0 1 0-4zM13 14a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"})})}),e.jsx("span",{className:"text-sm font-medium text-slate-900 capitalize truncate",children:t.label})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>{var e;if(!a)return;const s=`${window.location.origin}/events/${a}/webpages/${t.id}`;null==(e=navigator.clipboard)||e.writeText(s).catch(()=>{})},className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"Copy link",iconLeading:e.jsx(w,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>K(t.id,"delete"),className:"p-2 hover:text-red-600 "+(s?"text-slate-300 cursor-not-allowed opacity-50":"text-slate-400"),"aria-label":"Delete",disabled:s,iconLeading:e.jsx(b,{className:"h-4 w-4"})})]})]},t.id)})})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Preview"}),e.jsx("div",{className:"rounded-lg border border-slate-200 bg-white p-4",children:e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto",children:0===s.length?e.jsx("span",{className:"text-sm text-slate-500",children:"No menu items to preview."}):s.map(t=>{const a=t.id===i;return e.jsx("button",{type:"button",onClick:()=>V(t.id),className:"rounded-md px-3 py-1.5 text-sm font-medium transition-colors "+(a?"bg-violet-100 text-violet-700":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:t.label},t.id)})})})]})]})},J=()=>e.jsxs("div",{className:"flex items-center gap-3 flex-nowrap overflow-visible",children:[e.jsx(c,{variant:"secondary",size:"md",onClick:G,iconLeading:e.jsx(u,{className:"h-4 w-4"}),children:"Preview"}),e.jsx(c,{variant:"primary",size:"md",onClick:R,"data-custom-publish-button":"true",className:"bg-[#6938EF] hover:bg-[#5925DC] text-white whitespace-nowrap",iconLeading:e.jsx(x,{className:"h-4 w-4 flex-shrink-0"}),"aria-label":"Publish",children:"Publish"})]}),Q=()=>{$(!0)},Y=async e=>{if($(!1),"scratch"===e){const e={content:[],root:{props:{title:"Page 1",pageTitle:"Page 1"}},zones:{}};localStorage.setItem("create-from-scratch-page1",JSON.stringify(e)),localStorage.setItem("create-from-scratch","true"),localStorage.setItem("create-from-scratch-origin","event-website");try{const e=(null==y?void 0:y.uuid)??localStorage.getItem("currentEventUuid");e&&localStorage.setItem(`create-from-scratch-origin-${e}`,"event-website")}catch{}return window.history.pushState({},"","/event/website/editor/page1?mode=blank"),void window.dispatchEvent(new PopStateEvent("popstate"))}const t=(e=>({scratch:"Create from scratch",attendee:"Attendee page",schedule:"Schedule","html-general":"HTML/General page",folder:"Folder",organization:"Organization page",hyperlink:"Hyperlink","qr-scanner":"App QR Scanner",documents:"Documents list",gallery:"Gallery page",forms:"Forms","meeting-room":"Meeting room"}[e]||"New Page"))(e),a=`page-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;"schedule"===e?(k({id:a,name:t,slug:t.toLowerCase().replace(/[^a-z0-9]+/g,"-"),source:"advanced-component",type:"schedule",component:"SchedulePage"}),await _(a,t)):(k({id:a,name:t,slug:t.toLowerCase().replace(/[^a-z0-9]+/g,"-"),source:"modal-created"}),window.history.pushState({},"",`/event/website/editor/${a}`),window.dispatchEvent(new PopStateEvent("popstate")))},_=async(e,t)=>{try{Date.now()}catch(a){}},K=(e,t)=>{const a=T.find(t=>t.uuid===e);if(!a)return;const s="welcome"===a.name.toLowerCase();switch(t){case"view":window.history.pushState({},"",`/event/website/preview/${e}`),window.dispatchEvent(new PopStateEvent("popstate"));break;case"edit":window.history.pushState({},"",`/event/website/editor/${e}`),window.dispatchEvent(new PopStateEvent("popstate"));break;case"duplicate":break;case"delete":if(s)return void alert("The welcome page cannot be deleted.");A({id:e,name:a.name})}},X=async()=>{M&&(U(e=>e.filter(e=>e.uuid!==M.id)),A(null))};return f?e.jsxs("div",{className:"w-full h-full",children:[e.jsxs("div",{className:"flex-1 p-8 bg-white overflow-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 w-full",children:[e.jsx("h1",{className:"text-[26px] font-bold text-primary-dark",children:"Event Website"}),J()]}),e.jsxs("div",{className:"flex items-center justify-between mb-6 border-b border-slate-200",children:[e.jsxs("div",{className:"flex gap-6",children:[e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>D("website-pages"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative "+("website-pages"===P?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Website pages"}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>D("website-header"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative "+("website-header"===P?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Navigation"})]}),e.jsx(c,{variant:"primary",size:"md",onClick:Q,iconLeading:e.jsx(h,{className:"h-4 w-4"}),children:"New page"})]}),"website-pages"===P&&e.jsx("div",{children:e.jsx("div",{className:"space-y-0 border border-slate-200 rounded-lg bg-white",children:B?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:"Loading webpages..."})}):0===T.length?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:'No pages yet. Click "+ New Page" to create one.'})}):T.map(t=>{const a="welcome"===t.name.toLowerCase();return e.jsxs("div",{className:"flex items-center justify-between py-2 px-4 border-b border-slate-200 last:border-b-0 hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"text-sm font-medium text-slate-900 capitalize",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>K(t.uuid,"view"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"View",iconLeading:e.jsx(u,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>K(t.uuid,"edit"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"Edit",iconLeading:e.jsx(p,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>K(t.uuid,"duplicate"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"Duplicate",iconLeading:e.jsx(v,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>K(t.uuid,"delete"),className:"p-2 hover:text-red-600 "+(a?"text-slate-300 cursor-not-allowed opacity-50":"text-slate-400"),"aria-label":"Delete",disabled:a,iconLeading:e.jsx(b,{className:"h-4 w-4"})})]})]},t.uuid)})})}),"website-header"===P&&q()]}),e.jsx(r,{isVisible:I,onClose:()=>$(!1),onSelect:Y}),M&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Delete Page"}),e.jsxs("p",{className:"text-sm text-slate-600 mb-6",children:['Are you sure you want to delete "',M.name,'"? This action cannot be undone.']}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(c,{variant:"secondary",size:"md",onClick:()=>A(null),children:"Cancel"}),e.jsx(c,{variant:"primary",size:"md",onClick:X,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]}):e.jsxs("div",{className:"h-screen overflow-hidden bg-white",children:[e.jsx(l,{eventName:L||"Highly important conference of 2025",isDraft:!0,onBackClick:g,onSearchClick:()=>{},onNotificationClick:()=>{},onProfileClick:()=>{},userAvatarUrl:j},(null==y?void 0:y.uuid)||"no-event"),e.jsx(o,{items:O,activeItemId:"event-website",onItemClick:e=>{if(f)return;if("event-hub"===e)return window.history.pushState({},"","/event/hub"),void window.dispatchEvent(new PopStateEvent("popstate"));return n.some(t=>t.id===e)?(window.history.pushState({section:e},"",`/event/hub?section=${e}`),void window.dispatchEvent(new PopStateEvent("popstate"))):void 0}}),e.jsxs("div",{className:"flex-1 p-8 bg-white overflow-x-auto overflow-y-auto ml-[250px] mt-16 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 w-full",children:[e.jsx("h1",{className:"text-[26px] font-bold text-primary-dark",children:"Event Website"}),J()]}),e.jsxs("div",{className:"flex items-center justify-between mb-6 border-b border-slate-200",children:[e.jsxs("div",{className:"flex gap-6",children:[e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>D("website-pages"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative "+("website-pages"===P?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Website pages"}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>D("website-header"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative "+("website-header"===P?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Navigation"})]}),e.jsx(c,{variant:"primary",size:"md",onClick:Q,iconLeading:e.jsx(h,{className:"h-4 w-4"}),children:"New page"})]}),"website-pages"===P&&e.jsx("div",{children:e.jsx("div",{className:"space-y-0 border border-slate-200 rounded-lg bg-white",children:B?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:"Loading webpages..."})}):0===T.length?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:'No pages yet. Click "+ New Page" to create one.'})}):T.map(t=>{const a="welcome"===t.name.toLowerCase();return e.jsxs("div",{className:"flex items-center justify-between py-2 px-4 border-b border-slate-200 last:border-b-0 hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"text-sm font-medium text-slate-900 capitalize",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>K(t.uuid,"view"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"View",iconLeading:e.jsx(u,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>K(t.uuid,"edit"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"Edit",iconLeading:e.jsx(p,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>K(t.uuid,"duplicate"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"Duplicate",iconLeading:e.jsx(v,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>K(t.uuid,"delete"),className:"p-2 hover:text-red-600 "+(a?"text-slate-300 cursor-not-allowed opacity-50":"text-slate-400"),"aria-label":"Delete",disabled:a,iconLeading:e.jsx(b,{className:"h-4 w-4"})})]})]},t.uuid)})})}),"website-header"===P&&q()]}),e.jsx(r,{isVisible:I,onClose:()=>$(!1),onSelect:Y}),M&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Delete Page"}),e.jsxs("p",{className:"text-sm text-slate-600 mb-6",children:['Are you sure you want to delete "',M.name,'"? This action cannot be undone.']}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(c,{variant:"secondary",size:"md",onClick:()=>A(null),children:"Cancel"}),e.jsx(c,{variant:"primary",size:"md",onClick:X,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})};export{g as E};
