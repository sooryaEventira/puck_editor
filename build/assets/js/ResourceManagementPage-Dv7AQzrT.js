import{j as e}from"./puck-vendor-BeE6vXWX.js";import{r as t,R as s}from"./react-vendor-BdxBrZfF.js";import{M as l,u as a,I as i,E as n,s as r}from"./index-Uxn3yAjE.js";import{d as o,E as d}from"./EventHubContent-CwVy8wez.js";import{v as c,X as u,e as m,I as p,c as x,d as f,a as h,f as v,S as b,F as y,k as j,w as g,x as w}from"./icons-vendor-B3tUBqWS.js";import{B as N}from"./Button-Ch-bJN4k.js";import{d as C,a as k,c as S,f as I,b as E,e as D,u as F}from"./resourceService-DBBEW7zO.js";import{U as M}from"./UploadModal-Ci0apRNV.js";const R=({isOpen:s,onClose:l,options:a,position:i})=>{const n=t.useRef(null);return t.useEffect(()=>{const e=e=>{n.current&&!n.current.contains(e.target)&&l()};if(s)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s,l]),s?e.jsx("div",{ref:n,className:"fixed z-50 rounded-lg border border-slate-200 bg-white shadow-lg py-1",style:{left:`${i.x}px`,top:`${i.y}px`,width:"max-content"},children:a.map((t,s)=>e.jsx("button",{type:"button",onClick:()=>{t.action(),l()},className:"block w-full px-2.5 py-1.5 text-left text-sm transition-colors whitespace-nowrap "+("destructive"===t.variant?"text-rose-600 hover:bg-rose-50":"text-slate-700 hover:bg-slate-50"),children:t.label},s))}):null},T=({isVisible:s,onClose:a,onMove:i,folders:n,currentFolderId:r,fileName:o})=>{const[d,u]=t.useState(null);return e.jsx(l,{isVisible:s,onClose:a,title:"Move to folder",subtitle:`Move "${o}" to a folder`,width:400,footer:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(N,{variant:"secondary",onClick:a,children:"Cancel"}),e.jsx(N,{variant:"primary",onClick:()=>{i(d),a()},children:"Move"})]}),children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Select folder"}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[e.jsxs("button",{type:"button",onClick:()=>u(null),className:"w-full flex items-center gap-3 px-3 py-2 rounded-md text-left transition-colors "+(null===d?"bg-primary/10 border border-primary":"hover:bg-slate-50 border border-transparent"),children:[e.jsx(c,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-sm text-slate-700",children:"All media (root)"})]}),n.filter(e=>e.id!==r).map(t=>e.jsxs("button",{type:"button",onClick:()=>u(t.id),className:"w-full flex items-center gap-3 px-3 py-2 rounded-md text-left transition-colors "+(d===t.id?"bg-primary/10 border border-primary":"hover:bg-slate-50 border border-transparent"),children:[e.jsx(c,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-sm text-slate-700",children:t.name})]},t.id))]})]})})})},V=({isVisible:s,onClose:i,onConfirm:n,itemName:r,itemType:o,itemId:d})=>{const[c,m]=t.useState(!1),{createdEvent:p}=a();t.useEffect(()=>{s||m(!1)},[s]);return e.jsx(l,{isVisible:s,onClose:i,title:"",subtitle:"",width:400,padding:{top:24,right:24,bottom:0,left:24},showCloseButton:!1,showHeaderBorder:!1,customHeader:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("h2",{className:"text-xl font-semibold text-slate-900",children:["Delete ","folder"===o?"folder":"file"]})}),e.jsx("button",{type:"button",onClick:i,className:"inline-flex h-9 w-9 -mt-1 items-center justify-center rounded-md text-slate-500 transition-colors hover:bg-slate-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:e.jsx(u,{className:"h-5 w-5"})})]}),footer:e.jsxs("div",{className:"flex justify-end gap-3 py-4 -mt-2 bg-white",children:[e.jsx(N,{variant:"secondary",onClick:i,disabled:c,children:"Cancel"}),e.jsx(N,{variant:"destructive",onClick:async()=>{if((null==p?void 0:p.uuid)&&d){m(!0);try{"folder"===o?await C(d,p.uuid):"file"===o&&await k(d,p.uuid),n(),i()}catch(e){}finally{m(!1)}}},disabled:c,children:c?"Deleting...":"Delete"})]}),children:e.jsx("div",{className:"pt-0 pb-2",children:e.jsxs("p",{className:"text-md text-slate-600 leading-relaxed",children:['Are you sure you want to delete "',r,'"? This action cannot be undone.']})})})},L=({isVisible:s,onClose:a,onSave:n,fileName:r})=>{const[o,d]=t.useState(""),[c,p]=t.useState(""),x=()=>{d(""),p(""),a()};return e.jsx(l,{isVisible:s,onClose:x,title:"",subtitle:"",width:400,padding:{top:24,right:24,bottom:0,left:24},showCloseButton:!1,showHeaderBorder:!1,customHeader:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Gallery/Shortcut"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Create gallery or shortcut to display in your website"})]}),e.jsx("button",{type:"button",onClick:x,className:"inline-flex h-9 w-9 -mt-1 items-center justify-center rounded-md text-slate-500 transition-colors hover:bg-slate-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:e.jsx(u,{className:"h-5 w-5"})})]}),footer:e.jsxs("div",{className:"flex justify-end gap-3 py-4 -mt-2 bg-white",children:[e.jsx(N,{variant:"secondary",onClick:x,children:"Cancel"}),e.jsx(N,{variant:"primary",onClick:()=>{o.trim()&&c&&(n(o.trim(),c),x())},disabled:!o.trim()||!c,children:"Save shortcut"})]}),children:e.jsxs("div",{className:"pt-4 pb-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Shortcut name"}),e.jsx(i,{type:"text",value:o,onChange:e=>d(e.target.value),placeholder:"eg.Photo gallery",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Display type (File/Folder)"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:c,onChange:e=>p(e.target.value),className:"w-full appearance-none rounded-lg border border-slate-300 bg-white px-3 py-2 pr-10 text-sm text-slate-700 shadow-sm transition placeholder:text-slate-400 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:[e.jsx("option",{value:"",children:"Select type"}),[{value:"file",label:"File"},{value:"folder",label:"Folder"}].map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),e.jsx("div",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(m,{className:"h-4 w-4 text-slate-400"})})]})]})]})})},B=({isVisible:s,onClose:a,onSave:i,itemName:n,itemType:r="folder"})=>{const[o,d]=t.useState(""),[c,p]=t.useState([]),[x,f]=t.useState(!1),h=()=>{d(""),p([]),f(!1),a()};return e.jsx(l,{isVisible:s,onClose:h,title:"",subtitle:"",width:400,padding:{top:24,right:24,bottom:0,left:24},showCloseButton:!1,showHeaderBorder:!1,customHeader:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Restrict"}),e.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:["Control who can view this ",r,"'s content"]})]}),e.jsx("button",{type:"button",onClick:h,className:"inline-flex h-9 w-9 -mt-1 items-center justify-center rounded-md text-slate-500 transition-colors hover:bg-slate-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:e.jsx(u,{className:"h-5 w-5"})})]}),footer:e.jsxs("div",{className:"flex justify-end gap-3 py-4 -mt-2 bg-white",children:[e.jsx(N,{variant:"secondary",onClick:h,children:"Cancel"}),e.jsx(N,{variant:"primary",onClick:()=>{i(o,c,x),h()},children:"Save"})]}),children:e.jsxs("div",{className:"pt-4 pb-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Visibility"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:o,onChange:e=>d(e.target.value),className:"w-full appearance-none rounded-lg border border-slate-300 bg-white px-3 py-2 pr-10 text-sm text-slate-700 shadow-sm transition placeholder:text-slate-400 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:[e.jsx("option",{value:"",children:"eg.Photo gallery"}),[{value:"public",label:"Public"},{value:"private",label:"Private"},{value:"restricted",label:"Restricted"}].map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),e.jsx("div",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(m,{className:"h-4 w-4 text-slate-400"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Allow access by group"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:c.join(","),onChange:e=>{const t=e.target.value?e.target.value.split(","):[];p(t)},multiple:!1,className:"w-full appearance-none rounded-lg border border-slate-300 bg-white px-3 py-2 pr-10 text-sm text-slate-700 shadow-sm transition placeholder:text-slate-400 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:[e.jsx("option",{value:"",children:"Select groups"}),[{value:"group1",label:"Group 1"},{value:"group2",label:"Group 2"},{value:"group3",label:"Group 3"}].map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),e.jsx("div",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(m,{className:"h-4 w-4 text-slate-400"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"applyToSubFolders",checked:x,onChange:e=>f(e.target.checked),className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/20"}),e.jsx("label",{htmlFor:"applyToSubFolders",className:"text-sm text-slate-700 cursor-pointer",children:"Apply restriction to all sub-folders"})]})]})})},P=({isVisible:s,onClose:i,onCreate:n,initialName:r="",parentFolderId:o=null})=>{const[d,c]=t.useState(r),[u,m]=t.useState(!1),p=t.useRef(null),{createdEvent:x}=a();t.useEffect(()=>{s&&(c(r),m(!1),setTimeout(()=>{var e,t;null==(e=p.current)||e.focus(),null==(t=p.current)||t.select()},100))},[s,r]);const f=async()=>{if(d.trim()&&!u&&(null==x?void 0:x.uuid)){m(!0);try{const e={name:d.trim(),event_uuid:x.uuid};o&&(e.parent=o);const t=await S(e);n({uuid:t.uuid,name:t.name}),c(""),i()}catch(e){e instanceof Error&&e.message.includes("already exists")&&n({uuid:"",name:""})}finally{m(!1)}}};return e.jsx(l,{isVisible:s,onClose:i,title:r?"Rename folder":"Create folder",subtitle:r?"Enter a new name for this folder":"Enter a name for the new folder",width:400,showHeaderBorder:!1,footer:e.jsxs("div",{className:"flex justify-end gap-3 mb-4",children:[e.jsx(N,{variant:"secondary",onClick:i,disabled:u,children:"Cancel"}),e.jsx(N,{variant:"primary",onClick:f,disabled:!d.trim()||u,children:u?"Creating...":r?"Rename":"Create"})]}),children:e.jsx("div",{className:"space-y-4 mb-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Folder name"}),e.jsx("input",{ref:p,type:"text",value:d,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"===e.key?f():"Escape"===e.key&&i()},className:"w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",placeholder:"Enter folder name",autoFocus:!0})]})})})},U=({eventName:l,isDraft:i,onBackClick:u,userAvatarUrl:m,onCardClick:C,hideNavbarAndSidebar:k=!1})=>{const{eventData:S,createdEvent:U}=a(),A=(null==U?void 0:U.eventName)||(null==S?void 0:S.eventName)||l||"Highly important conference of 2025",$=void 0===i||i,[H,O]=t.useState([]),[G,W]=t.useState([]),[X,_]=t.useState([]),[K,z]=t.useState(!1),[Y,q]=t.useState(""),[J,Q]=t.useState("all"),[Z,ee]=t.useState(null),[te,se]=t.useState(null),[le,ae]=t.useState(null),[ie,ne]=t.useState(!1),[re,oe]=t.useState(null),[de,ce]=t.useState(!1),[ue,me]=t.useState(null),[pe,xe]=t.useState(!1),[fe,he]=t.useState(null),[ve,be]=t.useState(!1),[ye,je]=t.useState(null),[ge,we]=t.useState(!1),[Ne,Ce]=t.useState(!1),[ke,Se]=t.useState(null),[Ie,Ee]=t.useState(""),[De,Fe]=t.useState(null),[Me,Re]=t.useState(""),Te=t.useRef(null),Ve=t.useRef(null),Le=t.useRef(null),Be=t.useRef({}),Pe=t.useRef({}),Ue=t.useMemo(()=>{const t=o.map(e=>({id:e.id,label:e.title,icon:e.icon}));return[{id:"overview",label:"Overview",icon:e.jsx(p,{className:"h-5 w-5"})},{id:"event-website",label:"Event website",icon:e.jsx(x,{className:"h-5 w-5"})},{id:"event-hub",label:"Event Hub",icon:e.jsx(f,{className:"h-5 w-5"}),subItems:t}]},[]),Ae=t.useCallback(async()=>{if(null==U?void 0:U.uuid){z(!0);try{const e=(await I(U.uuid)).map(e=>({id:e.uuid,name:e.name,files:[],parentId:e.parent||null}));O(e)}catch(e){}finally{z(!1)}}},[null==U?void 0:U.uuid]),$e=t.useCallback(async()=>{if(null==U?void 0:U.uuid){z(!0);try{const e=(await E(U.uuid,te)).map(e=>({id:e.uuid,name:e.name,files:[],parentId:e.parent||null}));W(e)}catch(e){}finally{z(!1)}}},[null==U?void 0:U.uuid,te]);t.useEffect(()=>{Ae()},[Ae]),t.useEffect(()=>{$e()},[$e]);const He=t.useCallback(async()=>{if(null==U?void 0:U.uuid)try{const e=(await D(te)).map(e=>{var t;const s=(null==(t=e.name.split(".").pop())?void 0:t.toLowerCase())||"",l=e.content_type||"";let a="other";return["jpg","jpeg","png","gif","webp","svg"].includes(s)||l.startsWith("image/")?a="image":["pdf","doc","docx","xls","xlsx","txt"].includes(s)||l.includes("pdf")||l.includes("document")||l.includes("spreadsheet")?a="document":(["mp4","avi","mov","wmv","flv","webm"].includes(s)||l.startsWith("video/"))&&(a="video"),{id:e.uuid,name:e.name,type:a,file:null,preview:"image"===a?e.file:void 0,url:e.file,folderId:e.folder||te||null}});_(e)}catch(e){}},[null==U?void 0:U.uuid,te]);t.useEffect(()=>{He()},[He]);const Oe=e=>{se(e)},Ge=(e,t)=>{e.preventDefault(),e.stopPropagation(),ae({isOpen:!0,x:e.clientX,y:e.clientY,type:"file",id:t})},We=(e,t)=>{t.trim()&&W(s=>s.map(s=>s.id===e?{...s,name:t.trim()}:s)),Se(null),Ee("")},Xe=(e,t)=>{"Enter"===e.key?We(t,Ie):"Escape"===e.key&&(Se(null),Ee(""))},_e=(e,t)=>{const s=[],l=t.filter(t=>t.parentId===e);for(const a of l){s.push(a.id);const e=_e(a.id,t);s.push(...e)}return s},Ke=(e,t)=>{t.trim()&&_(s=>s.map(s=>s.id===e?{...s,name:t.trim()}:s)),Fe(null),Re("")},ze=(e,t)=>{"Enter"===e.key?Ke(t,Me):"Escape"===e.key&&(Fe(null),Re(""))},Ye=async e=>{const t=(e.url||e.preview||"").trim();if(t)try{await(async e=>{var t;if(null==(t=navigator.clipboard)?void 0:t.writeText)return void(await navigator.clipboard.writeText(e));const s=document.createElement("textarea");s.value=e,s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select(),document.execCommand("copy"),document.body.removeChild(s)})(t),r.success("Link copied")}catch(s){r.error("Failed to copy link. Please try again.")}else r.error("No file link available to copy.")},qe=t.useMemo(()=>{const e=[{id:null,name:"All media"}];if(!te)return e;const t=(e,s)=>{if(!e)return s;const l=H.find(t=>t.id===e);return l?(s.push({id:l.id,name:l.name}),l.parentId?t(l.parentId,s):s):s},s=t(te,[]).reverse();return[...e,...s]},[te,H]),Je=e=>{e.preventDefault()},Qe=e=>{var t;return(null==(t=e.split(".").pop())?void 0:t.toLowerCase())||""},Ze=t=>{if("image"===t.type)return null;if((e=>{const t=Qe(e.name);return["xls","xlsx","xlsm","xlsb"].includes(t)})(t)){const s=Qe(t.name).toUpperCase()||"XLS";return e.jsx("div",{className:"relative h-12 w-12 flex-shrink-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative h-10 w-8",children:[e.jsx("div",{className:"absolute left-0 top-0 h-10 w-8 bg-[#079455] rounded-sm"}),e.jsx("div",{className:"absolute left-5 top-0.5 h-2.5 w-2.5 bg-white opacity-30 rounded-sm"}),e.jsx("div",{className:"absolute left-0.5 top-[18px] w-7 text-center text-[8px] font-bold leading-none text-white",style:{fontFamily:"Inter"},children:s})]})})}if((e=>{const t=Qe(e.name);return["doc","docx","docm"].includes(t)})(t)){const s=Qe(t.name).toUpperCase()||"DOC";return e.jsx("div",{className:"relative h-12 w-12 flex-shrink-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative h-10 w-8",children:[e.jsx("div",{className:"absolute left-0 top-0 h-10 w-8 bg-[#2B579A] rounded-sm"}),e.jsx("div",{className:"absolute left-5 top-0.5 h-2.5 w-2.5 bg-white opacity-30 rounded-sm"}),e.jsx("div",{className:"absolute left-0.5 top-[18px] w-7 text-center text-[8px] font-bold leading-none text-white",style:{fontFamily:"Inter"},children:s})]})})}return"document"===t.type||t.type,e.jsx(w,{className:"h-12 w-12 text-slate-400"})},et=t.useMemo(()=>{let e=G.filter(e=>null===te?null===e.parentId||void 0===e.parentId:String(e.parentId)===String(te));return Y&&(e=e.filter(e=>e.name.toLowerCase().includes(Y.toLowerCase()))),e},[G,te,Y]),tt=t.useMemo(()=>{let e=X.filter(e=>e.folderId===te);return"all"!==J&&(e=e.filter(e=>e.type===J)),Y&&(e=e.filter(e=>e.name.toLowerCase().includes(Y.toLowerCase()))),e},[X,te,J,Y]);return e.jsxs("div",{className:"min-h-screen overflow-x-hidden bg-white",children:[!k&&e.jsxs(e.Fragment,{children:[e.jsx(n,{eventName:A,isDraft:$,onBackClick:u,onSearchClick:()=>{},onNotificationClick:()=>{},onProfileClick:()=>{},userAvatarUrl:m}),e.jsx(d,{items:Ue,activeItemId:"resource-management",onItemClick:e=>{if("event-hub"===e&&u)u();else if("resource-management"!==e){o.some(t=>t.id===e)&&C&&C(e)}}})]}),e.jsx("div",{className:k?"":"md:pl-[250px]",children:e.jsxs("div",{className:"space-y-6 px-4 pb-12 pt-8 md:px-10 lg:px-16",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsx("h1",{className:"text-[26px] font-bold text-primary-dark",children:"Resource Management"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{variant:"secondary",onClick:()=>{Ce(!0)},iconLeading:e.jsx(h,{className:"h-4 w-4"}),children:"Upload"}),e.jsx(N,{variant:"primary",onClick:()=>{we(!0)},iconLeading:e.jsx(v,{className:"h-4 w-4"}),children:"New folder"})]})]}),e.jsx("input",{ref:Te,type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.txt,video/*",onChange:e=>{const t=e.target.files;t&&(Array.from(t).forEach(e=>{var t;const s=`file-${Date.now()}-${Math.random()}`,l=(null==(t=e.name.split(".").pop())?void 0:t.toLowerCase())||"";let a="other";["jpg","jpeg","png","gif","webp","svg"].includes(l)?a="image":["pdf","doc","docx","xls","xlsx","txt"].includes(l)?a="document":["mp4","avi","mov","wmv","flv","webm"].includes(l)&&(a="video");const i={id:s,name:e.name,type:a,file:e,preview:"image"===a?URL.createObjectURL(e):void 0,folderId:te};_(e=>[...e,i])}),Te.current&&(Te.current.value=""))},className:"hidden"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center justify-between gap-3 mb-0",children:[e.jsx("div",{className:"flex items-end -mb-16",children:e.jsx("button",{type:"button",onClick:()=>Q("all"),className:"text-sm font-medium transition-colors pb-2 "+("all"===J?"text-primary border-b-2 border-primary":"text-slate-600 hover:text-primary"),children:"All media"})}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex flex-1 sm:flex-none items-center border border-slate-200 rounded-lg overflow-hidden bg-white",children:[e.jsx("input",{type:"text",value:Y,onChange:e=>q(e.target.value),placeholder:"Search resources",className:"px-3 py-2 text-sm text-slate-600 placeholder:text-slate-400 focus:outline-none w-full sm:w-[300px] border-0"}),e.jsx("button",{type:"button",className:"inline-flex h-10 w-10 items-center justify-center bg-primary text-white transition hover:bg-primary/90 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 flex-shrink-0 rounded-none","aria-label":"Search",children:e.jsx(b,{className:"h-4 w-4",strokeWidth:2})})]}),e.jsx("button",{type:"button",onClick:()=>{},className:"inline-flex shrink-0 h-10 w-10 items-center justify-center rounded-lg border border-slate-200 bg-white text-slate-500 transition hover:border-primary/40 hover:text-primary focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40","aria-label":"Filter resources",children:e.jsx(y,{className:"h-4 w-4",strokeWidth:2})})]})]}),e.jsxs("div",{className:"border border-slate-200 rounded-lg bg-white min-h-[400px]",children:[e.jsx("div",{className:"px-4 md:px-8 pt-4 pb-2 border-b border-slate-200",children:e.jsx("div",{className:"flex items-center gap-2 text-sm",children:qe.map((t,l)=>e.jsxs(s.Fragment,{children:[l>0&&e.jsx(j,{className:"h-4 w-4 text-slate-400"}),e.jsx("button",{type:"button",onClick:()=>se(t.id),className:""+(l===qe.length-1?"text-slate-900 font-medium":"text-slate-600 hover:text-primary"),children:t.name})]},t.id||"root"))})}),e.jsxs("div",{className:"p-4 md:p-8",children:[et.length>0&&e.jsx("div",{className:"flex flex-wrap gap-4 mb-6",children:et.map(t=>e.jsxs("div",{ref:e=>Be.current[t.id]=e,className:"group relative inline-flex flex-col items-center gap-2 p-3 hover:bg-primary/10 bg-white  hover:shadow-md transition-all ",onContextMenu:e=>((e,t)=>{e.preventDefault(),e.stopPropagation(),ae({isOpen:!0,x:e.clientX,y:e.clientY,type:"folder",id:t})})(e,t.id),onDragOver:Je,onDrop:()=>{return e=t.id,void(Z&&(_(t=>t.map(t=>t.id===Z?{...t,folderId:e}:t)),ee(null)));var e},children:[e.jsx("div",{className:"w-10 h-10 flex items-center justify-center cursor-pointer",onClick:()=>{ke!==t.id&&Oe(t.id)},children:e.jsx(c,{className:"h-8 w-8 text-primary"})}),ke===t.id?e.jsx("input",{ref:Ve,type:"text",value:Ie,onChange:e=>Ee(e.target.value),onBlur:()=>We(t.id,Ie),onKeyDown:e=>Xe(e,t.id),className:"text-sm font-medium text-slate-700 text-center max-w-[80px] px-1 py-0.5  focus:outline-none focus:ring-1 focus:ring-primary",onClick:e=>e.stopPropagation()}):e.jsx("span",{className:"text-sm font-medium text-slate-700 text-center max-w-[100px] line-clamp-2 cursor-pointer",onClick:()=>{ke!==t.id&&Oe(t.id)},children:t.name})]},t.id))}),tt.length>0&&e.jsx("div",{className:"grid grid-cols-2  sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8",children:tt.map(t=>e.jsxs("div",{ref:e=>Pe.current[t.id]=e,draggable:!0,onDragStart:()=>{return e=t.id,void ee(e);var e},className:"group relative flex w-32 cursor-move flex-col items-center justify-center gap-2 rounded-lg border border-slate-200 bg-white p-2 hover:shadow-md transition-all",onContextMenu:e=>Ge(e,t.id),children:[e.jsxs("div",{className:"relative flex h-24 w-full flex-col items-end justify-between rounded-lg overflow-hidden bg-slate-50 flex-shrink-0",children:["image"===t.type&&t.preview?e.jsx("img",{src:t.preview,alt:t.name,className:"absolute inset-0 h-full w-full object-cover",onError:e=>{var t;const s=e.currentTarget;s.style.display="none";const l=null==(t=s.parentElement)?void 0:t.querySelector(".file-icon-fallback");l&&(l.style.display="flex")}}):null,e.jsx("div",{className:"absolute inset-0 flex items-center justify-center file-icon-fallback "+("image"===t.type&&t.preview?"hidden":""),children:Ze(t)}),e.jsx("button",{type:"button",className:"relative z-10 flex h-8 w-8 cursor-pointer items-center justify-center rounded-full bg-white/90 backdrop-blur-sm border border-slate-300 p-0 transition-all opacity-0 group-hover:opacity-100 hover:bg-white",onClick:e=>{e.stopPropagation(),Ge(e,t.id)},"aria-label":"More options",children:e.jsx(g,{className:"h-4 w-4 text-slate-600"})})]}),De===t.id?e.jsx("input",{ref:Le,type:"text",value:Me,onChange:e=>Re(e.target.value),onBlur:()=>Ke(t.id,Me),onKeyDown:e=>ze(e,t.id),className:"w-full text-xs font-medium text-slate-700 text-center px-1 py-0.5 rounded border border-primary focus:outline-none focus:ring-1 focus:ring-primary",onClick:e=>e.stopPropagation()}):e.jsx("div",{className:"w-full break-words text-center text-xs font-medium text-slate-700 line-clamp-2 min-h-[2rem] flex items-center justify-center",children:t.name})]},t.id))}),0===et.length&&0===tt.length&&e.jsx("div",{className:"flex min-h-[400px] items-center justify-center text-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{className:"h-16 w-16 text-slate-400 mx-auto"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-slate-600",children:"No files found"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:Y?"Try adjusting your search terms":"Upload media files or create folders to get started"})]})]})})]})]}),le&&e.jsx(R,{isOpen:le.isOpen,onClose:()=>ae(null),options:(()=>{if(!le)return[];if("folder"===le.type){const e=G.find(e=>e.id===le.id);return e?[{label:"Rename",action:()=>{(e=>{const t=G.find(t=>t.id===e);t&&(Se(e),Ee(t.name),setTimeout(()=>{var e,t;null==(e=Ve.current)||e.focus(),null==(t=Ve.current)||t.select()},0))})(e.id)}},{label:"Delete",action:()=>{me({id:e.id,name:e.name,type:"folder"}),ce(!0)},variant:"destructive"}]:[]}{const e=X.find(e=>e.id===le.id);return e?[{label:"Rename",action:()=>{(e=>{const t=X.find(t=>t.id===e);t&&(Fe(e),Re(t.name),setTimeout(()=>{var e,t;null==(e=Le.current)||e.focus(),null==(t=Le.current)||t.select()},0))})(e.id)}},{label:"Copy link",action:()=>{Ye(e)}},{label:"Move to folder",action:()=>{oe(e),ne(!0)}},{label:"Duplicate",action:()=>(e=>{var t;const s=X.find(t=>t.id===e);if(s){const e={...s,id:`file-${Date.now()}-${Math.random()}`,name:`${s.name.replace(/\.[^/.]+$/,"")} (copy)${(null==(t=s.name.match(/\.[^/.]+$/))?void 0:t[0])||""}`};_(t=>[...t,e])}})(e.id)},{label:"Share/Gallery shortcut",action:()=>{he(e),xe(!0)}},{label:"Restrict access",action:()=>{je({id:e.id,name:e.name,type:"file"}),be(!0)}},{label:"Delete",action:()=>{me({id:e.id,name:e.name,type:"file"}),ce(!0)},variant:"destructive"}]:[]}})(),position:{x:le.x,y:le.y}}),e.jsx(T,{isVisible:ie,onClose:()=>{ne(!1),oe(null)},onMove:e=>{var t,s;re&&(t=re.id,s=e,_(e=>e.map(e=>e.id===t?{...e,folderId:s}:e)),oe(null))},folders:G,currentFolderId:(null==re?void 0:re.folderId)||void 0,fileName:(null==re?void 0:re.name)||""}),e.jsx(V,{isVisible:de,onClose:()=>{ce(!1),me(null)},onConfirm:()=>{var e;ue&&("folder"===ue.type?(e=>{const t=_e(e,H);O(s=>s.filter(s=>s.id!==e&&!t.includes(s.id))),W(s=>s.filter(s=>s.id!==e&&!t.includes(s.id)));const s=[e,...t];_(e=>e.filter(e=>!s.includes(e.folderId||""))),te&&(te===e||t.includes(te))&&se(null),$e()})(ue.id):(e=ue.id,_(t=>t.filter(t=>t.id!==e)),He()))},itemName:(null==ue?void 0:ue.name)||"",itemType:(null==ue?void 0:ue.type)||"file",itemId:null==ue?void 0:ue.id}),e.jsx(L,{isVisible:pe,onClose:()=>{xe(!1),he(null)},onSave:(e,t)=>{},fileName:null==fe?void 0:fe.name}),e.jsx(B,{isVisible:ve,onClose:()=>{be(!1),je(null)},onSave:(e,t,s)=>{},itemName:null==ye?void 0:ye.name,itemType:(null==ye?void 0:ye.type)||"folder"}),e.jsx(P,{isVisible:ge,onClose:()=>we(!1),onCreate:e=>{Ae(),$e(),we(!1)},parentFolderId:te}),e.jsx(M,{isOpen:Ne,onClose:()=>Ce(!1),onUpload:async e=>{var t;if(null==U?void 0:U.uuid){for(const l of e)try{const e=await F({file:l,event_uuid:U.uuid,parent:te||void 0}),s=(null==(t=l.name.split(".").pop())?void 0:t.toLowerCase())||"",a=e.content_type||"";let i="other";["jpg","jpeg","png","gif","webp","svg"].includes(s)||a.startsWith("image/")?i="image":["pdf","doc","docx","xls","xlsx","txt"].includes(s)||a.includes("pdf")||a.includes("document")||a.includes("spreadsheet")?i="document":(["mp4","avi","mov","wmv","flv","webm"].includes(s)||a.startsWith("video/"))&&(i="video");const n={id:e.uuid,name:e.name,type:i,file:l,preview:"image"===i?e.file:void 0,folderId:e.folder||te||null};_(e=>[...e,n])}catch(s){}He()}},title:"Upload and attach files",description:"Upload and attach files to this project.",uploadText:"Click to upload or drag and drop",accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.txt,video/*",multiple:!0,showTemplate:!1,buttonText:"Attach files",cancelButtonText:"Cancel",instructions:["SVG, PNG, JPG or GIF (max. 800Ã—400px)"]})]})})]})};export{U as default};
