import{j as e}from"./puck-vendor-DXoNcV6M.js";import{r as t}from"./react-vendor-BdxBrZfF.js";import{u as a,f as s,g as i,P as r,E as l}from"./index-D5FrvZEG.js";import{d as n,E as o}from"./EventHubContent-B0JxVqMT.js";import{B as c}from"./Button-DSYkMfy1.js";import{I as d,c as m,d as h,f as x,E as u,W as p,Y as b,i as v}from"./icons-vendor-BSdtBVbM.js";const w=({onBackClick:w,userAvatarUrl:g,hideNavbarAndSidebar:f=!1})=>{const{eventData:j,createdEvent:y}=a(),{pages:N,addPage:k,deletePage:C,duplicatePage:E,initializePages:S}=s(),z=t.useMemo(()=>(null==y?void 0:y.eventName)||(null==j?void 0:j.eventName),[null==y?void 0:y.eventName,null==y?void 0:y.uuid,null==j?void 0:j.eventName]),[L,P]=t.useState("website-pages"),[D,I]=t.useState(!1),[W,$]=t.useState(null),[A,H]=t.useState([]),[M,T]=t.useState(!1),U=t.useCallback(async()=>{if(null==y?void 0:y.uuid){T(!0);try{const e=await i(y.uuid);H(e)}catch(e){}finally{T(!1)}}else H([])},[null==y?void 0:y.uuid]);t.useEffect(()=>{U()},[U]),t.useEffect(()=>{const e=e=>{const{eventUuid:t}=e.detail;t===(null==y?void 0:y.uuid)&&U()};return window.addEventListener("webpage-saved",e),()=>{window.removeEventListener("webpage-saved",e)}},[null==y?void 0:y.uuid,U]),t.useEffect(()=>{if("blank"===new URLSearchParams(window.location.search).get("mode")||"true"===localStorage.getItem("create-from-scratch")){N.length>0&&N.forEach(e=>{var t,a;"welcome"===(null==(t=e.name)?void 0:t.toLowerCase())||null==(a=e.id)||a.toLowerCase(),C(e.id)});try{localStorage.removeItem("website-pages")}catch(e){}0===N.length&&S("scratch")}else N.length>0||S("default-template")},[N.length,S,C]),t.useEffect(()=>{const e=N.filter(e=>"schedule"===e.name.toLowerCase()||"schedule"===e.type);e.length>0&&e.forEach(e=>{C(e.id)})},[N,C]);const B=t.useMemo(()=>{const t=n.map(e=>({id:e.id,label:e.title,icon:e.icon}));return[{id:"overview",label:"Overview",icon:e.jsx(d,{className:"h-5 w-5"})},{id:"event-website",label:"Event website",icon:e.jsx(m,{className:"h-5 w-5"})},{id:"event-hub",label:"Event Hub",icon:e.jsx(h,{className:"h-5 w-5"}),subItems:t}]},[]),V=()=>{if(A.length>0){const e=A[0];window.history.pushState({},"",`/event/website/preview/${e.uuid}`),window.dispatchEvent(new PopStateEvent("popstate"))}},F=()=>{},O=()=>e.jsxs("div",{className:"flex items-center gap-3 flex-nowrap overflow-visible",children:[e.jsx(c,{variant:"secondary",size:"md",onClick:V,iconLeading:e.jsx(u,{className:"h-4 w-4"}),children:"Preview"}),e.jsx(c,{variant:"primary",size:"md",onClick:F,"data-custom-publish-button":"true",className:"bg-[#6938EF] hover:bg-[#5925DC] text-white whitespace-nowrap",iconLeading:e.jsx(h,{className:"h-4 w-4 flex-shrink-0"}),"aria-label":"Publish",children:"Publish"})]}),G=()=>{I(!0)},R=async e=>{if(I(!1),"scratch"===e){const e={content:[],root:{props:{title:"Page 1",pageTitle:"Page 1"}},zones:{}};localStorage.setItem("create-from-scratch-page1",JSON.stringify(e)),localStorage.setItem("create-from-scratch","true"),localStorage.setItem("create-from-scratch-origin","event-website");try{const e=(null==y?void 0:y.uuid)??localStorage.getItem("currentEventUuid");e&&localStorage.setItem(`create-from-scratch-origin-${e}`,"event-website")}catch{}return window.history.pushState({},"","/event/website/editor/page1?mode=blank"),void window.dispatchEvent(new PopStateEvent("popstate"))}const t=(e=>({scratch:"Create from scratch",attendee:"Attendee page",schedule:"Schedule","html-general":"HTML/General page",folder:"Folder",organization:"Organization page",hyperlink:"Hyperlink","qr-scanner":"App QR Scanner",documents:"Documents list",gallery:"Gallery page",forms:"Forms","meeting-room":"Meeting room"}[e]||"New Page"))(e),a=`page-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;"schedule"===e?(k({id:a,name:t,slug:t.toLowerCase().replace(/[^a-z0-9]+/g,"-"),source:"advanced-component",type:"schedule",component:"SchedulePage"}),await q(a,t)):(k({id:a,name:t,slug:t.toLowerCase().replace(/[^a-z0-9]+/g,"-"),source:"modal-created"}),window.history.pushState({},"",`/event/website/editor/${a}`),window.dispatchEvent(new PopStateEvent("popstate")))},q=async(e,t)=>{try{Date.now()}catch(a){}},J=(e,t)=>{const a=A.find(t=>t.uuid===e);if(!a)return;const s="welcome"===a.name.toLowerCase();switch(t){case"view":window.history.pushState({},"",`/event/website/preview/${e}`),window.dispatchEvent(new PopStateEvent("popstate"));break;case"edit":window.history.pushState({},"",`/event/website/editor/${e}`),window.dispatchEvent(new PopStateEvent("popstate"));break;case"duplicate":break;case"delete":if(s)return void alert("The welcome page cannot be deleted.");$({id:e,name:a.name})}},Q=async()=>{W&&(H(e=>e.filter(e=>e.uuid!==W.id)),$(null))};return f?e.jsxs("div",{className:"w-full h-full",children:[e.jsxs("div",{className:"flex-1 p-8 bg-white overflow-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 w-full",children:[e.jsx("h1",{className:"text-[26px] font-bold text-primary-dark",children:"Event Website"}),O()]}),e.jsxs("div",{className:"flex items-center justify-between mb-6 border-b border-slate-200",children:[e.jsxs("div",{className:"flex gap-6",children:[e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>P("website-pages"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative "+("website-pages"===L?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Website pages"}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>P("website-header"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative "+("website-header"===L?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Website header"})]}),e.jsx(c,{variant:"primary",size:"md",onClick:G,iconLeading:e.jsx(x,{className:"h-4 w-4"}),children:"New page"})]}),"website-pages"===L&&e.jsx("div",{children:e.jsx("div",{className:"space-y-0 border border-slate-200 rounded-lg bg-white",children:M?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:"Loading webpages..."})}):0===A.length?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:'No pages yet. Click "+ New Page" to create one.'})}):A.map(t=>{const a="welcome"===t.name.toLowerCase();return e.jsxs("div",{className:"flex items-center justify-between py-2 px-4 border-b border-slate-200 last:border-b-0 hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"text-sm font-medium text-slate-900 capitalize",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>J(t.uuid,"view"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"View",iconLeading:e.jsx(u,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>J(t.uuid,"edit"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"Edit",iconLeading:e.jsx(p,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>J(t.uuid,"duplicate"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"Duplicate",iconLeading:e.jsx(b,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>J(t.uuid,"delete"),className:"p-2 hover:text-red-600 "+(a?"text-slate-300 cursor-not-allowed opacity-50":"text-slate-400"),"aria-label":"Delete",disabled:a,iconLeading:e.jsx(v,{className:"h-4 w-4"})})]})]},t.uuid)})})}),"website-header"===L&&e.jsx("div",{children:e.jsx("p",{className:"text-slate-600",children:"Website header settings will be implemented here."})})]}),e.jsx(r,{isVisible:D,onClose:()=>I(!1),onSelect:R}),W&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Delete Page"}),e.jsxs("p",{className:"text-sm text-slate-600 mb-6",children:['Are you sure you want to delete "',W.name,'"? This action cannot be undone.']}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(c,{variant:"secondary",size:"md",onClick:()=>$(null),children:"Cancel"}),e.jsx(c,{variant:"primary",size:"md",onClick:Q,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]}):e.jsxs("div",{className:"h-screen overflow-hidden bg-white",children:[e.jsx(l,{eventName:z||"Highly important conference of 2025",isDraft:!0,onBackClick:w,onSearchClick:()=>{},onNotificationClick:()=>{},onProfileClick:()=>{},userAvatarUrl:g},(null==y?void 0:y.uuid)||"no-event"),e.jsx(o,{items:B,activeItemId:"event-website",onItemClick:e=>{if(f)return;if("event-hub"===e)return window.history.pushState({},"","/event/hub"),void window.dispatchEvent(new PopStateEvent("popstate"));return n.some(t=>t.id===e)?(window.history.pushState({section:e},"",`/event/hub?section=${e}`),void window.dispatchEvent(new PopStateEvent("popstate"))):void 0}}),e.jsxs("div",{className:"flex-1 p-8 bg-white overflow-x-auto overflow-y-auto ml-[250px] mt-16 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6 w-full",children:[e.jsx("h1",{className:"text-[26px] font-bold text-primary-dark",children:"Event Website"}),O()]}),e.jsxs("div",{className:"flex items-center justify-between mb-6 border-b border-slate-200",children:[e.jsxs("div",{className:"flex gap-6",children:[e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>P("website-pages"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative "+("website-pages"===L?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Website pages"}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>P("website-header"),className:"pb-3 px-1 h-auto rounded-none border-b-2 transition-colors relative "+("website-header"===L?"text-primary border-b-primary":"text-slate-600 hover:text-slate-900 border-b-transparent"),children:"Website header"})]}),e.jsx(c,{variant:"primary",size:"md",onClick:G,iconLeading:e.jsx(x,{className:"h-4 w-4"}),children:"New page"})]}),"website-pages"===L&&e.jsx("div",{children:e.jsx("div",{className:"space-y-0 border border-slate-200 rounded-lg bg-white",children:M?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:"Loading webpages..."})}):0===A.length?e.jsx("div",{className:"flex items-center justify-center py-8 text-slate-500",children:e.jsx("p",{children:'No pages yet. Click "+ New Page" to create one.'})}):A.map(t=>{const a="welcome"===t.name.toLowerCase();return e.jsxs("div",{className:"flex items-center justify-between py-2 px-4 border-b border-slate-200 last:border-b-0 hover:bg-slate-50 transition-colors",children:[e.jsx("span",{className:"text-sm font-medium text-slate-900 capitalize",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>J(t.uuid,"view"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"View",iconLeading:e.jsx(u,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>J(t.uuid,"edit"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"Edit",iconLeading:e.jsx(p,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>J(t.uuid,"duplicate"),className:"p-2 text-slate-400 hover:text-slate-600","aria-label":"Duplicate",iconLeading:e.jsx(b,{className:"h-4 w-4"})}),e.jsx(c,{variant:"tertiary",size:"sm",onClick:()=>J(t.uuid,"delete"),className:"p-2 hover:text-red-600 "+(a?"text-slate-300 cursor-not-allowed opacity-50":"text-slate-400"),"aria-label":"Delete",disabled:a,iconLeading:e.jsx(v,{className:"h-4 w-4"})})]})]},t.uuid)})})}),"website-header"===L&&e.jsx("div",{children:e.jsx("p",{className:"text-slate-600",children:"Website header settings will be implemented here."})})]}),e.jsx(r,{isVisible:D,onClose:()=>I(!1),onSelect:R}),W&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Delete Page"}),e.jsxs("p",{className:"text-sm text-slate-600 mb-6",children:['Are you sure you want to delete "',W.name,'"? This action cannot be undone.']}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(c,{variant:"secondary",size:"md",onClick:()=>$(null),children:"Cancel"}),e.jsx(c,{variant:"primary",size:"md",onClick:Q,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})};export{w as E};
