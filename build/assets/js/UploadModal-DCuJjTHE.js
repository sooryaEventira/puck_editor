import{j as e}from"./puck-vendor-BeE6vXWX.js";import{r as t}from"./react-vendor-BdxBrZfF.js";import{D as s,a as l,X as a}from"./icons-vendor-DZgrt25s.js";import{B as i}from"./Button-Cs4W-qkT.js";const r=({isOpen:r,onClose:n,onUpload:o,onAttachFiles:c,title:f="Upload and attach files",description:d,uploadText:x="Click to upload, drag and drop xlsx",accept:m=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",multiple:p=!0,showTemplate:u=!0,templateLabel:h="Template",onDownloadTemplate:g,buttonText:j="Attach files",cancelButtonText:v="Cancel",instructions:y,maxFileSize:w})=>{const[b,N]=t.useState(!1),[D,k]=t.useState([]),[F,A]=t.useState(!1),C=t.useRef(null),I=o||c;if(t.useEffect(()=>{r||k([])},[r]),!r)return null;const B=e=>{if(e&&e.length>0){const t=Array.from(e),s=w?t.filter(e=>e.size<=w):t;if(s.length<t.length){const e=t.length-s.length;alert(`${e} file(s) exceeded the maximum file size of ${P(w)}`)}k(p?e=>[...e,...s]:s.slice(0,1))}},P=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]},E=()=>{var e;null==(e=C.current)||e.click()};return e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50 p-4",onClick:e=>{e.target===e.currentTarget&&n()},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation()},children:e.jsxs("div",{className:"relative w-full max-w-[400px] overflow-hidden rounded-lg bg-white shadow-2xl",onClick:e=>e.stopPropagation(),onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation()},children:[e.jsxs("div",{className:"relative flex w-full flex-col items-center justify-start",children:[e.jsx("div",{className:"flex w-full flex-col items-start justify-start gap-2 self-stretch px-6 pt-4",children:e.jsxs("div",{className:"flex w-full flex-col items-start justify-start gap-0.5 self-stretch",children:[e.jsx("div",{className:"w-full text-base font-semibold leading-6 text-[#181D27]",style:{fontFamily:"Inter"},children:f}),d&&e.jsx("div",{className:"w-full text-sm font-normal leading-5 text-[#535862]",style:{fontFamily:"Inter"},children:d})]})}),e.jsx("button",{type:"button",onClick:n,className:"absolute right-3 top-3 flex h-9 w-9 items-center justify-center overflow-hidden rounded-lg p-2",children:e.jsx("div",{className:"relative h-5 w-5 overflow-hidden",children:e.jsx("svg",{className:"absolute left-1.5 top-1.5 h-3 w-3 text-[#A4A7AE]",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 3L3 9M3 3L9 9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})}),e.jsx("div",{className:"h-3 w-full"})]}),e.jsx("div",{className:"flex w-full flex-col items-start justify-start gap-3 px-6",children:e.jsxs("div",{className:"flex w-full flex-col items-start justify-start gap-3 self-stretch",children:[u&&e.jsx("div",{className:"flex w-full flex-col items-start justify-start gap-2 self-stretch",children:e.jsxs("div",{className:"relative flex w-full items-start justify-start gap-1 overflow-hidden rounded-xl border border-[#E9EAEB] bg-white p-4 outline outline-1 outline-[#E9EAEB] outline-offset-[-1px] "+(g?"cursor-pointer hover:bg-slate-50 transition-colors":""),onClick:g?e=>{e.stopPropagation(),g()}:void 0,children:[e.jsxs("div",{className:"flex flex-1 items-start justify-start gap-3",children:[e.jsxs("div",{className:"relative h-10 w-10 flex-shrink-0",children:[e.jsxs("div",{className:"absolute left-1 top-0 h-10 w-8",children:[e.jsx("div",{className:"absolute left-0 top-0 h-10 w-8 bg-[#079455]"}),e.jsx("div",{className:"absolute left-5 top-0 h-3 w-3 bg-white opacity-30"})]}),e.jsx("div",{className:"absolute left-1 top-[23px] w-8 text-center text-[9px] font-bold leading-none text-white",style:{fontFamily:"Inter"},children:"XLSX"})]}),e.jsx("div",{className:"flex flex-1 flex-col items-start justify-start gap-1",children:e.jsxs("div",{className:"flex w-full flex-col items-start justify-start gap-0.5 self-stretch",children:[e.jsx("div",{className:"w-full text-base font-semibold leading-6 text-[#181D27]",style:{fontFamily:"Inter"},children:h}),e.jsx("div",{className:"inline-flex w-full items-center justify-start gap-2 self-stretch",children:e.jsx("span",{className:"text-sm font-normal leading-5 "+(g?"text-[#5925DC] hover:underline cursor-pointer":"text-[#535862]"),style:{fontFamily:"Inter"},children:"Download template"})})]})})]}),g&&e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),g()},className:"absolute right-2 top-2 flex items-center justify-center overflow-hidden rounded-md p-1.5 hover:bg-slate-100 transition-colors",children:e.jsx("div",{className:"relative h-4 w-4 overflow-hidden",children:e.jsx(s,{className:"absolute left-0.5 top-0.5 h-3 w-3 text-[#A4A7AE]",strokeWidth:1.5})})})]})}),e.jsx("div",{onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),N(!0)},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),N(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation();const t=e.currentTarget.getBoundingClientRect(),s=e.clientX,l=e.clientY;(s<t.left||s>t.right||l<t.top||l>t.bottom)&&N(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),N(!1),B(e.dataTransfer.files)},onClick:E,className:"flex w-full cursor-pointer flex-col items-center justify-start gap-1 self-stretch rounded-xl border-2 border-dashed bg-white px-6 py-6 outline outline-2 outline-offset-[-2px] transition-colors "+(b?"border-[#7A5AF8] outline-[#7A5AF8] bg-purple-50":"border-[#7A5AF8] outline-[#7A5AF8] hover:bg-slate-50"),children:e.jsxs("div",{className:"flex w-full flex-col items-center justify-start gap-2 self-stretch pointer-events-none",children:[e.jsxs("div",{className:"relative h-10 w-10 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-white border-2 border-[#7A5AF8]"}),e.jsx(l,{className:"relative h-5 w-5 text-[#7A5AF8]",strokeWidth:2})]}),e.jsx("div",{className:"flex w-full flex-col items-center justify-start gap-1 self-stretch",children:e.jsx("div",{className:"inline-flex w-full items-start justify-center gap-1 self-stretch",children:x.includes(" or ")?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-semibold leading-5 text-[#5925DC] pointer-events-auto cursor-pointer",style:{fontFamily:"Inter"},onClick:E,children:x.split(" or ")[0]}),e.jsx("span",{className:"text-sm font-normal leading-5 text-[#535862]",style:{fontFamily:"Inter"},children:" or "+x.split(" or ")[1]})]}):e.jsx("span",{className:"text-sm font-semibold leading-5 text-[#5925DC] pointer-events-auto cursor-pointer",style:{fontFamily:"Inter"},onClick:E,children:x})})})]})}),e.jsx("input",{ref:C,type:"file",multiple:p,accept:m,onChange:e=>{B(e.target.files)},className:"hidden"}),D.length>0&&e.jsxs("div",{className:"flex w-full flex-col items-start justify-start gap-2 self-stretch",children:[e.jsxs("div",{className:"text-sm font-medium leading-5 text-[#181D27]",style:{fontFamily:"Inter"},children:["Selected files (",D.length,")"]}),e.jsx("div",{className:"flex w-full flex-col items-start justify-start gap-2 self-stretch max-h-40 overflow-y-auto",children:D.map((t,s)=>e.jsxs("div",{className:"flex w-full items-center justify-between gap-3 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[e.jsxs("div",{className:"flex flex-1 items-center justify-start gap-2 min-w-0",children:[e.jsxs("div",{className:"relative h-8 w-8 flex-shrink-0",children:[e.jsxs("div",{className:"absolute left-0.5 top-0 h-8 w-7",children:[e.jsx("div",{className:"absolute left-0 top-0 h-8 w-7 bg-[#079455]"}),e.jsx("div",{className:"absolute left-4 top-0 h-2.5 w-2.5 bg-white opacity-30"})]}),e.jsx("div",{className:"absolute left-0.5 top-[18px] w-7 text-center text-[8px] font-bold leading-none text-white",style:{fontFamily:"Inter"},children:"XLSX"})]}),e.jsxs("div",{className:"flex flex-1 flex-col items-start justify-start gap-0.5 min-w-0",children:[e.jsx("div",{className:"w-full truncate text-sm font-medium leading-5 text-[#181D27]",style:{fontFamily:"Inter"},children:t.name}),e.jsx("div",{className:"text-xs font-normal leading-4 text-[#535862]",style:{fontFamily:"Inter"},children:P(t.size)})]})]}),e.jsx("button",{type:"button",onClick:()=>(e=>{k(t=>t.filter((t,s)=>s!==e))})(s),className:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-md text-slate-400 hover:bg-slate-200 hover:text-slate-600 transition-colors","aria-label":"Remove file",children:e.jsx(a,{className:"h-4 w-4"})})]},s))})]}),y&&y.length>0&&e.jsx("div",{className:"flex w-full flex-col items-start justify-start gap-1 self-stretch",children:y.map((t,s)=>e.jsx("div",{className:"text-sm font-normal leading-5 text-[#535862]",style:{fontFamily:"Inter"},children:t},s))})]})}),e.jsx("div",{className:"flex w-full flex-col items-start justify-start pt-4",children:e.jsxs("div",{className:"inline-flex w-full items-start justify-start gap-3 self-stretch px-6 pb-4",children:[e.jsx(i,{type:"button",variant:"secondary",size:"lg",onClick:n,className:"flex-1",style:{fontFamily:"Inter"},children:v}),e.jsx(i,{type:"button",variant:"primary",size:"lg",onClick:async()=>{if(0!==D.length&&I){A(!0);try{await I(D),k([]),n()}catch(e){}finally{A(!1)}}},disabled:0===D.length||F||!I,className:"flex-1",style:{fontFamily:"Inter"},children:F?"Uploading...":j})]})})]})})};export{r as U};
