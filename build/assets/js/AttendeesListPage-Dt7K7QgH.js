import{j as e}from"./puck-vendor-BeE6vXWX.js";import{r as t}from"./react-vendor-BdxBrZfF.js";import{S as s,F as a}from"./icons-vendor-B3tUBqWS.js";import{r as n}from"./eventLocalStore-CWbqpkVu.js";import{f as r}from"./publicAttendeeService-CFOV4Dzm.js";import{n as l,b as i}from"./indexedSearch-DGht6u-v.js";import"./index-BmzR9LWJ.js";const o=({attendee:t})=>{const s=[t.post,t.institute].filter(Boolean).join(" â€¢ ");return e.jsxs("div",{className:"flex items-center gap-4 rounded-xl border border-slate-200 bg-white p-4 shadow-sm",children:[t.avatarUrl?e.jsx("img",{src:t.avatarUrl,alt:t.name,className:"h-12 w-12 rounded-full object-cover ring-1 ring-slate-200"}):e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-slate-100 ring-1 ring-slate-200 text-xs font-semibold text-slate-500",children:(t.name||"A").split(" ").filter(Boolean).map(e=>e[0]).join("").toUpperCase().slice(0,2)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-slate-900",children:t.name}),s?e.jsx("div",{className:"truncate text-xs text-slate-500",children:s}):null]})]})},d=({eventUuid:d,onNavigate:c})=>{const[m,u]=t.useState(""),[x,h]=t.useState("all"),[p,f]=t.useState(null),[j,v]=t.useState(!1);t.useEffect(()=>{let e=!1;return(async()=>{v(!0);try{const t=await r(d),s=(Array.isArray(t)?t:[]).map((e,t)=>({id:String(e.uuid??e.id??`attendee-${t}`),name:String(e.name??"").trim()||String([e.first_name,e.last_name].filter(Boolean).join(" ")).trim()||"Unknown",post:e.post??e.title??void 0,institute:e.institute??e.company??void 0,avatarUrl:e.avatarUrl??e.avatar_url??void 0}));e||f(s)}catch{e||f(null)}finally{e||v(!1)}})(),()=>{e=!0}},[d]);const b=t.useMemo(()=>p??n(d,"attendees",[]),[p,d]),g=t.useMemo(()=>{const e=new Set;return b.map((t,s)=>{const a=String((null==t?void 0:t.id)??"").trim(),n=l(null==t?void 0:t.name).replace(/\s+/g,"-")||"attendee";let r=a||`${n}-${s}`;for(;e.has(r);)r=`${r}-${s}`;return e.add(r),{...t,id:r}})},[b]),N=t.useMemo(()=>{const e=new Set;return g.forEach(t=>{const s=String(t.institute??"").trim();s&&e.add(s)}),Array.from(e).sort((e,t)=>e.localeCompare(t))},[g]),w=t.useMemo(()=>"all"===x?g:g.filter(e=>String(e.institute??"").trim()===x),[g,x]),y=t.useMemo(()=>i(w,e=>e.name),[w]),S=t.useMemo(()=>{const e=l(m);if(!e)return w;const t=e.split(" ").filter(Boolean);return y.filter(e=>t.every(t=>e.text.includes(t))).map(e=>e.item)},[y,w,m]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("h1",{className:"text-xl font-semibold text-slate-900",children:"Attendees"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center overflow-hidden rounded-md border border-slate-200 bg-white shadow-sm",children:[e.jsx("input",{value:m,onChange:e=>{u(e.target.value)},placeholder:"Search attendees",className:"w-[240px] px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:outline-none hover:border-primary",onKeyDown:e=>{"Enter"===e.key&&e.currentTarget.blur()}}),e.jsx("button",{type:"button",className:"flex h-9 w-10 items-center justify-center bg-primary text-white","aria-label":"Search",onClick:()=>{},children:e.jsx(s,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",className:"flex h-9 w-9 items-center justify-center rounded-md border border-slate-200 bg-white text-slate-600 shadow-sm hover:bg-slate-50","aria-label":"Filter",children:e.jsx(a,{className:"h-4 w-4"})}),e.jsxs("select",{value:x,onChange:e=>h(e.target.value),className:"absolute inset-0 h-9 w-9 cursor-pointer opacity-0","aria-label":"Filter by institute",children:[e.jsx("option",{value:"all",children:"All institutes"}),N.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Showing ",e.jsx("span",{className:"font-semibold text-slate-700",children:S.length})," of"," ",e.jsx("span",{className:"font-semibold text-slate-700",children:w.length})]}),0===S.length?e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-6",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900",children:j?"Loading attendeesâ€¦":"No attendees found"}),e.jsx("div",{className:"mt-1 text-sm text-slate-600",children:"Add attendees in Attendee Management to see them here."})]}):e.jsx("div",{className:"space-y-3",children:S.map((t,s)=>e.jsx("button",{type:"button",className:"w-full text-left",onClick:()=>c(`/events/${d}/attendees/${t.id}`),children:e.jsx(o,{attendee:t})},`${t.id}-${s}`))})]})};export{d as default};
