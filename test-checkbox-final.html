<!DOCTYPE html>
<html>
<head>
    <title>Checkbox Final Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Checkbox = ({ label, checked, onChange }) => {
            const getBooleanValue = (value) => {
                if (typeof value === 'string') {
                    return value === 'true';
                }
                return Boolean(value);
            };

            const [isChecked, setIsChecked] = useState(() => getBooleanValue(checked));

            useEffect(() => {
                const booleanValue = getBooleanValue(checked);
                console.log('Checkbox props updated:', { label, checked, booleanValue, currentState: isChecked });
                setIsChecked(booleanValue);
            }, [checked, label]);

            const handleChange = (e) => {
                const newValue = e.target.checked;
                console.log('Checkbox clicked:', { label, newValue, previous: isChecked });
                setIsChecked(newValue);
                if (onChange) {
                    onChange(newValue);
                }
            };

            return (
                <div 
                    key={`checkbox-${label}-${isChecked}`}
                    style={{ padding: "8px", border: "1px solid #e5e7eb", borderRadius: "4px", backgroundColor: "#f9fafb" }}
                >
                    <label
                        onClick={(e) => {
                            e.preventDefault();
                            const newValue = !isChecked;
                            console.log('Label clicked:', { label, newValue, previous: isChecked });
                            setIsChecked(newValue);
                            if (onChange) {
                                onChange(newValue);
                            }
                        }}
                        style={{
                            display: "flex",
                            alignItems: "center",
                            cursor: "pointer",
                            padding: "4px 0",
                            fontSize: "14px",
                            color: "#374151",
                        }}
                    >
                        <input
                            type="checkbox"
                            checked={isChecked}
                            onChange={handleChange}
                            style={{
                                marginRight: "8px",
                                width: "18px",
                                height: "18px",
                                cursor: "pointer",
                                accentColor: "#3b82f6"
                            }}
                        />
                        {label}
                    </label>
                    <div style={{ fontSize: "12px", color: "#6b7280", marginTop: "4px" }}>
                        Status: {isChecked ? "✅ Checked" : "❌ Unchecked"}
                    </div>
                </div>
            );
        };

        const TestApp = () => {
            const [checked, setChecked] = useState(false);
            
            return (
                <div style={{ padding: "20px" }}>
                    <h1>Checkbox Final Test</h1>
                    <p>Click the checkbox below to test:</p>
                    <Checkbox 
                        label="Test Checkbox" 
                        checked={checked} 
                        onChange={setChecked} 
                    />
                    <p style={{ marginTop: "20px" }}>
                        <strong>App State:</strong> {checked ? "✅ Checked" : "❌ Unchecked"}
                    </p>
                </div>
            );
        };

        ReactDOM.render(<TestApp />, document.getElementById('root'));
    </script>
</body>
</html>
